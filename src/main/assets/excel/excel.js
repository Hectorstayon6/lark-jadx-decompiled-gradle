"use strict";function styleInject(e,t){void 0===t&&(t={});var a=t.insertAt;if(e&&"undefined"!=typeof document){var r=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css","top"===a&&r.firstChild?r.insertBefore(n,r.firstChild):r.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}}var SECURE_LINK_ENV,SECURE_LINK_SCENE,SECURE_LINK_LOG,_a,css="body,div,html,img,span,table,tbody,td,th,thead,tr{box-sizing:border-box;margin:0;padding:0;-webkit-font-smoothing:antialiased;text-rendering:optimizeLegibility;font-size:xx-small}body,html{width:100%;height:100%;overflow:hidden;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Tahoma,PingFang SC,Microsoft Yahei,Arial,Hiragino Sans GB,sans-serif}.inner-table-box::-webkit-scrollbar,.tab-container::-webkit-scrollbar,.table-container::-webkit-scrollbar,body::-webkit-scrollbar{-webkit-appearance:none;background-color:transparent;width:7px;height:7px}.inner-table-box::-webkit-scrollbar-thumb,.tab-container::-webkit-scrollbar-thumb,.table-container::-webkit-scrollbar-thumb,body::-webkit-scrollbar-thumb{background:rgba(187,191,196,.5);width:7px;border-radius:3px;display:block;min-height:38px;min-width:38px}.inner-table-box::-webkit-scrollbar-track,.tab-container::-webkit-scrollbar-track,.table-container::-webkit-scrollbar-track,body::-webkit-scrollbar-track{background-color:transparent;display:block}.no-scrollbar{-ms-overflow-style:none}.no-scrollbar::-webkit-scrollbar{display:none}table{table-layout:fixed;width:1px}table td,table th{padding:2px;border-bottom:1px solid #dee0e3;border-right:1px solid #dee0e3;min-height:20px;position:relative;word-wrap:break-word;white-space:normal;font-size:xx-small}table td a.comment-indicator,table th a.comment-indicator{position:absolute;top:0;right:0;cursor:default;background:none;width:0;height:0;border:none;border-top:10px solid red;border-left:10px solid transparent}table td comment,table th comment{display:none!important}.container{width:100%;height:100%;position:relative}.container .table-container{width:calc(100% - 40px);overflow:auto;position:relative;left:40px}.container .table-container .table-box{position:relative;min-height:100%}.container .table-container .table-box .first-row-wrapper{position:fixed;top:0;height:24px;overflow:hidden;z-index:10;left:40px}.container .table-container .table-box .first-row-wrapper .first-row{height:24px;border-bottom:1px solid #dee0e3;min-width:100%;white-space:nowrap;background:#f5f6f7;color:#222;user-select:none;will-change:transform}.container .table-container .table-box .first-row-wrapper .first-row span{display:inline-block;height:24px;line-height:24px;text-align:center;border-right:1px solid #dee0e3;font-size:xx-small;background:#f5f6f7}.container .table-container .table-box .first-column-wrapper{z-index:10;position:fixed;top:0;left:0;height:100%;width:40px;overflow:hidden}.container .table-container .table-box .first-column-wrapper .first-column__fixed-head{position:fixed;top:0;left:0;border:1px solid #dee0e3;border-top:none;width:40px;height:24px;background:#f5f6f7;z-index:10}.container .table-container .table-box .first-column-wrapper .first-column{width:40px;border-left:1px solid #dee0e3;border-right:1px solid #dee0e3;min-height:100%;padding-top:24px;background:#f5f6f7;color:#222;user-select:none;will-change:transform}.container .table-container .table-box .first-column-wrapper .first-column span{display:block;width:100%;text-align:center;border-bottom:1px solid #dee0e3;padding-top:4px;font-size:xx-small;min-height:20px}.container .table-container .table-box .main-table{position:relative}.container .table-container .table-box .main-table .shadow-thead{visibility:hidden}.container .table-container .table-box .main-table .shadow-thead tr{height:24px}.container .table-container .table-box .main-table .active-item{border:1px solid #3370ff}.container .tab-container{bottom:0;left:0;position:absolute;border-top:1px solid #dee0e3;width:100%;overflow-x:auto;overflow-y:hidden;white-space:nowrap;background:#fff;z-index:10;height:42px;max-height:42px}.container .tab-container .tab{height:100%;border-right:1px solid #dee0e3;padding:10px;display:inline-block;font-size:14px;cursor:pointer;font-family:-apple-system,BlinkMacSystemFont,Helvetica Neue,Tahoma,PingFang SC,Microsoft Yahei,Arial,Hiragino Sans GB,sans-serif}.container .tab-container .tab--active{color:#3370ff}.container .tab-container--mobile{top:0;bottom:auto;border-top:none;border-bottom:1px solid #dee0e3}.spin-indicator{position:fixed;left:50%;top:50%;pointer-events:none;transform:translate(-50%,-50%)}.spin-indicator--hiden{display:none}.spin-indicator .spin-indicator-box{color:#3370ff;vertical-align:middle;text-align:center;-webkit-transition:-webkit-transform .3s cubic-bezier(.78,.14,.15,.86);transition:-webkit-transform .3s cubic-bezier(.78,.14,.15,.86);transition:transform .3s cubic-bezier(.78,.14,.15,.86);transition:transform .3s cubic-bezier(.78,.14,.15,.86),-webkit-transform .3s cubic-bezier(.78,.14,.15,.86);font-size:12px;opacity:1;position:static;display:inline-block}.spin-indicator .spin-indicator-box .spin-indicator-dots{position:relative;display:inline-block;width:20px;height:20px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);-webkit-animation:antRotate 1.2s linear infinite;animation:antRotate 1.2s linear infinite}.spin-indicator .spin-indicator-box .spin-indicator-dots .spin-indicator-dot1{left:0;top:0}.spin-indicator .spin-indicator-box .spin-indicator-dots .spin-indicator-dot2{right:0;top:0;-webkit-animation-delay:.4s;animation-delay:.4s}.spin-indicator .spin-indicator-box .spin-indicator-dots .spin-indicator-dot3{right:0;bottom:0;-webkit-animation-delay:.8s;animation-delay:.8s}.spin-indicator .spin-indicator-box .spin-indicator-dots .spin-indicator-dot4{left:0;bottom:0;-webkit-animation-delay:1.2s;animation-delay:1.2s}.spin-indicator .spin-indicator-box .spin-indicator-dots i{width:9px;height:9px;border-radius:100%;background-color:#3370ff;-webkit-transform:scale(.75);-ms-transform:scale(.75);transform:scale(.75);display:block;position:absolute;opacity:.3;-webkit-animation:antSpinMove 1s linear infinite alternate;animation:antSpinMove 1s linear infinite alternate;-webkit-transform-origin:50% 50%;-ms-transform-origin:50% 50%;transform-origin:50% 50%}@keyframes antRotate{to{-webkit-transform:rotate(405deg);transform:rotate(405deg)}}@keyframes antSpinMove{to{opacity:1}}.comment-content{position:fixed;display:none;white-space:pre-wrap;padding:6px;background:#fff;box-shadow:0 2px 12px 0 rgba(56,56,56,.2);border:1px solid #e2e6ed;border-radius:2px;color:#3d4757;overflow-y:auto;max-height:160px;max-width:230px}.unpreviewable-container{display:flex;flex-direction:column;justify-content:center;align-items:center;position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);width:100%;height:100%;background:#f8f9fb}.unpreviewable-container span{font-size:16px;margin-top:18px;max-width:80%;text-align:center}";function _defineProperty(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function ownKeys(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)}return a}function _objectSpread2(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(a),!0).forEach(function(e){_defineProperty(t,e,a[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):ownKeys(Object(a)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))})}return t}styleInject(css),function(e){e.LARK_ONLINE="LARK_ONLINE",e.LARK_STAGING="LARK_STAGING",e.FEISHU_ONLINE="FEISHU_ONLINE",e.FEISHU_STAGING="FEISHU_STAGING"}(SECURE_LINK_ENV=SECURE_LINK_ENV||{}),function(e){e.MESSENGER="messager",e.CCM="ccm",e.CALENDAR="calendar",e.EMAIL="email",e.OPENPLATFORM="openPlatform",e.VC="vc"}(SECURE_LINK_SCENE=SECURE_LINK_SCENE||{}),function(e){e.MESSENGER_CHAT="messenger_chat",e.MESSENGER_CHAT_SHARED_LINK_CARD="messenger_chat_shared_link_card",e.MESSENGER_SEARCH_LINK="messenger_search_link",e.MESSENGER_INCHAT_SEARCH_LINK="messenger_inchat_search_link",e.MESSENGER_PROFILE="messenger_profile",e.MESSENGER_SITE="messenger_site",e.MESSENGER_FAVORITE="messenger_favorite",e.MESSENGER_PIN="messenger_pin",e.MESSENGER_FILE="messenger_file",e.EVENT_DESCRIPTION="event_description",e.EVENT_ATTACHMENT_PREVIEW="event_attachment_preview",e.EMAIL_BODY="email_body",e.EMAIL_ATTACHMENT_PREVIEW="email_attachment_preview",e.CCM_DOCS="ccm_docs",e.CCM_SHEET="ccm_sheet",e.CCM_SLIDE="ccm_slide",e.CCM_BITABLE="ccm_bitable",e.CCM_MINDNOTE="ccm_mindnote",e.CCM_DRIVE="ccm_drive",e.DRIVESDK_CREATION="drivesdk_creation",e.DOCS_SDK_COMMENT="docs_sdk_comment",e.BITABLE_SDK_APPBUILDER="bitable_sdk_appbuilder",e.MESSENGER_GROUP_ANNOUNCEMENT="messenger_group_announcement",e.OPENDOC_CONFERENCE_RECORDS="opendoc_conference_records",e.OP_GADGET="op_gadget",e.OP_MESSAGE_CARD="op_message_card",e.OP_H5="op_H5"}(SECURE_LINK_LOG=SECURE_LINK_LOG||{});var envToBaseUrl=((_a={})[SECURE_LINK_ENV.LARK_STAGING]="https://security.larksuite-staging.com/link/safety",_a[SECURE_LINK_ENV.LARK_ONLINE]="https://security.larksuite.com/link/safety",_a[SECURE_LINK_ENV.FEISHU_STAGING]="https://security.feishu-staging.cn/link/safety",_a[SECURE_LINK_ENV.FEISHU_ONLINE]="https://security.feishu.cn/link/safety",_a),DEFAULT_WHITE_LIST=[".*\\.feishu-staging\\.cn$",".*\\.larksuite-staging\\.com$",".*\\.feishu-pre\\.cn$",".*\\.larksuite-pre\\.com$",".*\\.feishu\\.cn$",".*\\.larksuite\\.com$","^larksuite\\.help$","^getfeishu\\.cn$","^file\\.zjurl\\.cn$"],DEFAULT_SECURE_LINK_CONFIG={enable:!0,env:SECURE_LINK_ENV.FEISHU_ONLINE,whiteList:DEFAULT_WHITE_LIST},$config=DEFAULT_SECURE_LINK_CONFIG;function getDomainFromUrl(t){try{return new URL(t).hostname}catch(e){var a=/^((\w+):)?(\/\/((\w+)?(:(\w+))?@)?([^\/\?:]+)(:(\d+))?)?(\/?([^\/\?#][^\?#]*)?)?(\?([^#]+))?(#(\w*))?/.exec(t);return a&&a[8]||""}}function verify(e){return!("string"!=typeof e||!e)&&(/^(?:(\w+)\:)?\/\//.test(e)||(e="http://"+e),verifyDomain(getDomainFromUrl(e)))}function verifyDomain(t){return $config.whiteList.some(function(e){return e instanceof RegExp?e.test(t):"string"!=typeof e?"function"!=typeof e||e(t):new RegExp(e).test(t)})}function getSecureLink(e,t){return void 0===t&&(t={}),processSecureLink(e,t).targetUrl}function processSecureLink(e,t){void 0===t&&(t={});var a=verify(e);return{secure:a,targetUrl:a?e:concatSecureLink(e,t)}}function concatSecureLink(e,t){var a=$config.env,r=t.env||a,n=envToBaseUrl[r]||envToBaseUrl[a],o=t.scene||SECURE_LINK_SCENE.CCM,i=getLanguageFromOptions(t);return n+"?target="+encodeURIComponent(e)+"&scene="+o+"&logParams="+encodeURIComponent(JSON.stringify(t.logParams||{}))+"&lang="+i}function getLanguageFromOptions(e){if(e.lang)return e.lang;try{return navigator.language||""}catch(e){return""}}var locationTypes={doc:"drivesdk_creation",doc_file:"drivesdk_creation",bitable:"drivesdk_creation",default:"ccm_drive"};function getCustomSecureLink(e,t){var a=e.getAttribute("href");return a&&seclinkEnabled(e)?getSecureLink(a,_objectSpread2({},t,{logParams:getSceneOption()})):a}function getSearchParam(e){for(var t=window.location.search.substr(1).split("&"),a=0;a<t.length;a++){var r=t[a].split("=");if(2===r.length&&r[0]===e)return r[1]}return""}function getSceneOption(){var e=getSearchParam("source");return{location:locationTypes[e]||locationTypes.default}}function isAnchorUrl(e){var t=e.getAttribute("href");return t&&0===t.indexOf("#")}function seclinkEnabled(e){var t=getSearchParam("source"),a="calendar"===t||"email"===t;return"1"===getSearchParam("sl")&&!a&&!isAnchorUrl(e)}function seclinkReportInit(){document.addEventListener("click",function(e){"A"===e.target.tagName&&seclinkEnabled(e.target)&&parent.postMessage({key:"seclinkClicked"},"*")})}var freeGlobal="object"==typeof global&&global&&global.Object===Object&&global,freeSelf="object"==typeof self&&self&&self.Object===Object&&self,root=freeGlobal||freeSelf||Function("return this")(),Symbol=root.Symbol,objectProto=Object.prototype,hasOwnProperty=objectProto.hasOwnProperty,nativeObjectToString=objectProto.toString,symToStringTag=Symbol?Symbol.toStringTag:void 0;function getRawTag(e){var t=hasOwnProperty.call(e,symToStringTag),a=e[symToStringTag];try{var r=!(e[symToStringTag]=void 0)}catch(e){}var n=nativeObjectToString.call(e);return r&&(t?e[symToStringTag]=a:delete e[symToStringTag]),n}var objectProto$1=Object.prototype,nativeObjectToString$1=objectProto$1.toString;function objectToString(e){return nativeObjectToString$1.call(e)}var nullTag="[object Null]",undefinedTag="[object Undefined]",symToStringTag$1=Symbol?Symbol.toStringTag:void 0;function baseGetTag(e){return null==e?void 0===e?undefinedTag:nullTag:symToStringTag$1&&symToStringTag$1 in Object(e)?getRawTag(e):objectToString(e)}function isObjectLike(e){return null!=e&&"object"==typeof e}var symbolTag="[object Symbol]";function isSymbol(e){return"symbol"==typeof e||isObjectLike(e)&&baseGetTag(e)==symbolTag}var isArray=Array.isArray;function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}var NAN=NaN,reTrim=/^\s+|\s+$/g,reIsBadHex=/^[-+]0x[0-9a-f]+$/i,reIsBinary=/^0b[01]+$/i,reIsOctal=/^0o[0-7]+$/i,freeParseInt=parseInt;function toNumber(e){if("number"==typeof e)return e;if(isSymbol(e))return NAN;if(isObject(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=isObject(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(reTrim,"");var a=reIsBinary.test(e);return a||reIsOctal.test(e)?freeParseInt(e.slice(2),a?2:8):reIsBadHex.test(e)?NAN:+e}var asyncTag="[object AsyncFunction]",funcTag="[object Function]",genTag="[object GeneratorFunction]",proxyTag="[object Proxy]";function isFunction(e){if(!isObject(e))return!1;var t=baseGetTag(e);return t==funcTag||t==genTag||t==asyncTag||t==proxyTag}var coreJsData=root["__core-js_shared__"],maskSrcKey=function(){var e=/[^.]+$/.exec(coreJsData&&coreJsData.keys&&coreJsData.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function isMasked(e){return!!maskSrcKey&&maskSrcKey in e}var funcProto=Function.prototype,funcToString=funcProto.toString;function toSource(e){if(null!=e){try{return funcToString.call(e)}catch(e){}try{return e+""}catch(e){}}return""}var reRegExpChar=/[\\^$.*+?()[\]{}|]/g,reIsHostCtor=/^\[object .+?Constructor\]$/,funcProto$1=Function.prototype,objectProto$2=Object.prototype,funcToString$1=funcProto$1.toString,hasOwnProperty$1=objectProto$2.hasOwnProperty,reIsNative=RegExp("^"+funcToString$1.call(hasOwnProperty$1).replace(reRegExpChar,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function baseIsNative(e){return!(!isObject(e)||isMasked(e))&&(isFunction(e)?reIsNative:reIsHostCtor).test(toSource(e))}function getValue(e,t){return null==e?void 0:e[t]}function getNative(e,t){var a=getValue(e,t);return baseIsNative(a)?a:void 0}var WeakMap=getNative(root,"WeakMap"),MAX_SAFE_INTEGER=9007199254740991,reIsUint=/^(?:0|[1-9]\d*)$/;function isIndex(e,t){var a=typeof e;return!!(t=null==t?MAX_SAFE_INTEGER:t)&&("number"==a||"symbol"!=a&&reIsUint.test(e))&&-1<e&&e%1==0&&e<t}function eq(e,t){return e===t||e!=e&&t!=t}var MAX_SAFE_INTEGER$1=9007199254740991;function isLength(e){return"number"==typeof e&&-1<e&&e%1==0&&e<=MAX_SAFE_INTEGER$1}function isArrayLike(e){return null!=e&&isLength(e.length)&&!isFunction(e)}var objectProto$3=Object.prototype;function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||objectProto$3)}function baseTimes(e,t){for(var a=-1,r=Array(e);++a<e;)r[a]=t(a);return r}var argsTag="[object Arguments]";function baseIsArguments(e){return isObjectLike(e)&&baseGetTag(e)==argsTag}var objectProto$4=Object.prototype,hasOwnProperty$2=objectProto$4.hasOwnProperty,propertyIsEnumerable=objectProto$4.propertyIsEnumerable,isArguments=baseIsArguments(function(){return arguments}())?baseIsArguments:function(e){return isObjectLike(e)&&hasOwnProperty$2.call(e,"callee")&&!propertyIsEnumerable.call(e,"callee")};function stubFalse(){return!1}var freeExports="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule=freeExports&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports=freeModule&&freeModule.exports===freeExports,Buffer=moduleExports?root.Buffer:void 0,nativeIsBuffer=Buffer?Buffer.isBuffer:void 0,isBuffer=nativeIsBuffer||stubFalse,argsTag$1="[object Arguments]",arrayTag="[object Array]",boolTag="[object Boolean]",dateTag="[object Date]",errorTag="[object Error]",funcTag$1="[object Function]",mapTag="[object Map]",numberTag="[object Number]",objectTag="[object Object]",regexpTag="[object RegExp]",setTag="[object Set]",stringTag="[object String]",weakMapTag="[object WeakMap]",arrayBufferTag="[object ArrayBuffer]",dataViewTag="[object DataView]",float32Tag="[object Float32Array]",float64Tag="[object Float64Array]",int8Tag="[object Int8Array]",int16Tag="[object Int16Array]",int32Tag="[object Int32Array]",uint8Tag="[object Uint8Array]",uint8ClampedTag="[object Uint8ClampedArray]",uint16Tag="[object Uint16Array]",uint32Tag="[object Uint32Array]",typedArrayTags={};function baseIsTypedArray(e){return isObjectLike(e)&&isLength(e.length)&&!!typedArrayTags[baseGetTag(e)]}function baseUnary(t){return function(e){return t(e)}}typedArrayTags[float32Tag]=typedArrayTags[float64Tag]=typedArrayTags[int8Tag]=typedArrayTags[int16Tag]=typedArrayTags[int32Tag]=typedArrayTags[uint8Tag]=typedArrayTags[uint8ClampedTag]=typedArrayTags[uint16Tag]=typedArrayTags[uint32Tag]=!0,typedArrayTags[argsTag$1]=typedArrayTags[arrayTag]=typedArrayTags[arrayBufferTag]=typedArrayTags[boolTag]=typedArrayTags[dataViewTag]=typedArrayTags[dateTag]=typedArrayTags[errorTag]=typedArrayTags[funcTag$1]=typedArrayTags[mapTag]=typedArrayTags[numberTag]=typedArrayTags[objectTag]=typedArrayTags[regexpTag]=typedArrayTags[setTag]=typedArrayTags[stringTag]=typedArrayTags[weakMapTag]=!1;var freeExports$1="object"==typeof exports&&exports&&!exports.nodeType&&exports,freeModule$1=freeExports$1&&"object"==typeof module&&module&&!module.nodeType&&module,moduleExports$1=freeModule$1&&freeModule$1.exports===freeExports$1,freeProcess=moduleExports$1&&freeGlobal.process,nodeUtil=function(){try{var e=freeModule$1&&freeModule$1.require&&freeModule$1.require("util").types;return e||freeProcess&&freeProcess.binding&&freeProcess.binding("util")}catch(e){}}(),nodeIsTypedArray=nodeUtil&&nodeUtil.isTypedArray,isTypedArray=nodeIsTypedArray?baseUnary(nodeIsTypedArray):baseIsTypedArray,objectProto$5=Object.prototype,hasOwnProperty$3=objectProto$5.hasOwnProperty;function arrayLikeKeys(e,t){var a=isArray(e),r=!a&&isArguments(e),n=!a&&!r&&isBuffer(e),o=!a&&!r&&!n&&isTypedArray(e),i=a||r||n||o,s=i?baseTimes(e.length,String):[],l=s.length;for(var c in e)!t&&!hasOwnProperty$3.call(e,c)||i&&("length"==c||n&&("offset"==c||"parent"==c)||o&&("buffer"==c||"byteLength"==c||"byteOffset"==c)||isIndex(c,l))||s.push(c);return s}function overArg(t,a){return function(e){return t(a(e))}}var nativeKeys=overArg(Object.keys,Object),objectProto$6=Object.prototype,hasOwnProperty$4=objectProto$6.hasOwnProperty;function baseKeys(e){if(!isPrototype(e))return nativeKeys(e);var t=[];for(var a in Object(e))hasOwnProperty$4.call(e,a)&&"constructor"!=a&&t.push(a);return t}function keys(e){return isArrayLike(e)?arrayLikeKeys(e):baseKeys(e)}var nativeCreate=getNative(Object,"create");function hashClear(){this.__data__=nativeCreate?nativeCreate(null):{},this.size=0}function hashDelete(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var HASH_UNDEFINED="__lodash_hash_undefined__",objectProto$7=Object.prototype,hasOwnProperty$5=objectProto$7.hasOwnProperty;function hashGet(e){var t=this.__data__;if(nativeCreate){var a=t[e];return a===HASH_UNDEFINED?void 0:a}return hasOwnProperty$5.call(t,e)?t[e]:void 0}var objectProto$8=Object.prototype,hasOwnProperty$6=objectProto$8.hasOwnProperty;function hashHas(e){var t=this.__data__;return nativeCreate?void 0!==t[e]:hasOwnProperty$6.call(t,e)}var HASH_UNDEFINED$1="__lodash_hash_undefined__";function hashSet(e,t){var a=this.__data__;return this.size+=this.has(e)?0:1,a[e]=nativeCreate&&void 0===t?HASH_UNDEFINED$1:t,this}function Hash(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}function listCacheClear(){this.__data__=[],this.size=0}function assocIndexOf(e,t){for(var a=e.length;a--;)if(eq(e[a][0],t))return a;return-1}Hash.prototype.clear=hashClear,Hash.prototype.delete=hashDelete,Hash.prototype.get=hashGet,Hash.prototype.has=hashHas,Hash.prototype.set=hashSet;var arrayProto=Array.prototype,splice=arrayProto.splice;function listCacheDelete(e){var t=this.__data__,a=assocIndexOf(t,e);return!(a<0)&&(a==t.length-1?t.pop():splice.call(t,a,1),--this.size,!0)}function listCacheGet(e){var t=this.__data__,a=assocIndexOf(t,e);return a<0?void 0:t[a][1]}function listCacheHas(e){return-1<assocIndexOf(this.__data__,e)}function listCacheSet(e,t){var a=this.__data__,r=assocIndexOf(a,e);return r<0?(++this.size,a.push([e,t])):a[r][1]=t,this}function ListCache(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}ListCache.prototype.clear=listCacheClear,ListCache.prototype.delete=listCacheDelete,ListCache.prototype.get=listCacheGet,ListCache.prototype.has=listCacheHas,ListCache.prototype.set=listCacheSet;var Map=getNative(root,"Map");function mapCacheClear(){this.size=0,this.__data__={hash:new Hash,map:new(Map||ListCache),string:new Hash}}function isKeyable(e){var t=typeof e;return"string"==t||"number"==t||"symbol"==t||"boolean"==t?"__proto__"!==e:null===e}function getMapData(e,t){var a=e.__data__;return isKeyable(t)?a["string"==typeof t?"string":"hash"]:a.map}function mapCacheDelete(e){var t=getMapData(this,e).delete(e);return this.size-=t?1:0,t}function mapCacheGet(e){return getMapData(this,e).get(e)}function mapCacheHas(e){return getMapData(this,e).has(e)}function mapCacheSet(e,t){var a=getMapData(this,e),r=a.size;return a.set(e,t),this.size+=a.size==r?0:1,this}function MapCache(e){var t=-1,a=null==e?0:e.length;for(this.clear();++t<a;){var r=e[t];this.set(r[0],r[1])}}function arrayPush(e,t){for(var a=-1,r=t.length,n=e.length;++a<r;)e[n+a]=t[a];return e}function stackClear(){this.__data__=new ListCache,this.size=0}function stackDelete(e){var t=this.__data__,a=t.delete(e);return this.size=t.size,a}function stackGet(e){return this.__data__.get(e)}function stackHas(e){return this.__data__.has(e)}MapCache.prototype.clear=mapCacheClear,MapCache.prototype.delete=mapCacheDelete,MapCache.prototype.get=mapCacheGet,MapCache.prototype.has=mapCacheHas,MapCache.prototype.set=mapCacheSet;var LARGE_ARRAY_SIZE=200;function stackSet(e,t){var a=this.__data__;if(a instanceof ListCache){var r=a.__data__;if(!Map||r.length<LARGE_ARRAY_SIZE-1)return r.push([e,t]),this.size=++a.size,this;a=this.__data__=new MapCache(r)}return a.set(e,t),this.size=a.size,this}function Stack(e){var t=this.__data__=new ListCache(e);this.size=t.size}function arrayFilter(e,t){for(var a=-1,r=null==e?0:e.length,n=0,o=[];++a<r;){var i=e[a];t(i,a,e)&&(o[n++]=i)}return o}function stubArray(){return[]}Stack.prototype.clear=stackClear,Stack.prototype.delete=stackDelete,Stack.prototype.get=stackGet,Stack.prototype.has=stackHas,Stack.prototype.set=stackSet;var objectProto$9=Object.prototype,propertyIsEnumerable$1=objectProto$9.propertyIsEnumerable,nativeGetSymbols=Object.getOwnPropertySymbols,getSymbols=nativeGetSymbols?function(t){return null==t?[]:(t=Object(t),arrayFilter(nativeGetSymbols(t),function(e){return propertyIsEnumerable$1.call(t,e)}))}:stubArray;function baseGetAllKeys(e,t,a){var r=t(e);return isArray(e)?r:arrayPush(r,a(e))}function getAllKeys(e){return baseGetAllKeys(e,keys,getSymbols)}var DataView=getNative(root,"DataView"),Promise=getNative(root,"Promise"),Set=getNative(root,"Set"),mapTag$1="[object Map]",objectTag$1="[object Object]",promiseTag="[object Promise]",setTag$1="[object Set]",weakMapTag$1="[object WeakMap]",dataViewTag$1="[object DataView]",dataViewCtorString=toSource(DataView),mapCtorString=toSource(Map),promiseCtorString=toSource(Promise),setCtorString=toSource(Set),weakMapCtorString=toSource(WeakMap),getTag=baseGetTag;(DataView&&getTag(new DataView(new ArrayBuffer(1)))!=dataViewTag$1||Map&&getTag(new Map)!=mapTag$1||Promise&&getTag(Promise.resolve())!=promiseTag||Set&&getTag(new Set)!=setTag$1||WeakMap&&getTag(new WeakMap)!=weakMapTag$1)&&(getTag=function(e){var t=baseGetTag(e),a=t==objectTag$1?e.constructor:void 0,r=a?toSource(a):"";if(r)switch(r){case dataViewCtorString:return dataViewTag$1;case mapCtorString:return mapTag$1;case promiseCtorString:return promiseTag;case setCtorString:return setTag$1;case weakMapCtorString:return weakMapTag$1}return t});var getTag$1=getTag,Uint8Array=root.Uint8Array,HASH_UNDEFINED$2="__lodash_hash_undefined__";function setCacheAdd(e){return this.__data__.set(e,HASH_UNDEFINED$2),this}function setCacheHas(e){return this.__data__.has(e)}function SetCache(e){var t=-1,a=null==e?0:e.length;for(this.__data__=new MapCache;++t<a;)this.add(e[t])}function arraySome(e,t){for(var a=-1,r=null==e?0:e.length;++a<r;)if(t(e[a],a,e))return!0;return!1}function cacheHas(e,t){return e.has(t)}SetCache.prototype.add=SetCache.prototype.push=setCacheAdd,SetCache.prototype.has=setCacheHas;var COMPARE_PARTIAL_FLAG=1,COMPARE_UNORDERED_FLAG=2;function equalArrays(e,t,a,r,n,o){var i=a&COMPARE_PARTIAL_FLAG,s=e.length,l=t.length;if(s!=l&&!(i&&s<l))return!1;var c=o.get(e);if(c&&o.get(t))return c==t;var u=-1,d=!0,p=a&COMPARE_UNORDERED_FLAG?new SetCache:void 0;for(o.set(e,t),o.set(t,e);++u<s;){var h=e[u],f=t[u];if(r)var b=i?r(f,h,u,t,e,o):r(h,f,u,e,t,o);if(void 0!==b){if(b)continue;d=!1;break}if(p){if(!arraySome(t,function(e,t){if(!cacheHas(p,t)&&(h===e||n(h,e,a,r,o)))return p.push(t)})){d=!1;break}}else if(h!==f&&!n(h,f,a,r,o)){d=!1;break}}return o.delete(e),o.delete(t),d}function mapToArray(e){var a=-1,r=Array(e.size);return e.forEach(function(e,t){r[++a]=[t,e]}),r}function setToArray(e){var t=-1,a=Array(e.size);return e.forEach(function(e){a[++t]=e}),a}var COMPARE_PARTIAL_FLAG$1=1,COMPARE_UNORDERED_FLAG$1=2,boolTag$1="[object Boolean]",dateTag$1="[object Date]",errorTag$1="[object Error]",mapTag$2="[object Map]",numberTag$1="[object Number]",regexpTag$1="[object RegExp]",setTag$2="[object Set]",stringTag$1="[object String]",symbolTag$1="[object Symbol]",arrayBufferTag$1="[object ArrayBuffer]",dataViewTag$2="[object DataView]",symbolProto=Symbol?Symbol.prototype:void 0,symbolValueOf=symbolProto?symbolProto.valueOf:void 0;function equalByTag(e,t,a,r,n,o,i){switch(a){case dataViewTag$2:if(e.byteLength!=t.byteLength||e.byteOffset!=t.byteOffset)return!1;e=e.buffer,t=t.buffer;case arrayBufferTag$1:return!(e.byteLength!=t.byteLength||!o(new Uint8Array(e),new Uint8Array(t)));case boolTag$1:case dateTag$1:case numberTag$1:return eq(+e,+t);case errorTag$1:return e.name==t.name&&e.message==t.message;case regexpTag$1:case stringTag$1:return e==t+"";case mapTag$2:var s=mapToArray;case setTag$2:var l=r&COMPARE_PARTIAL_FLAG$1;if(s=s||setToArray,e.size!=t.size&&!l)return!1;var c=i.get(e);if(c)return c==t;r|=COMPARE_UNORDERED_FLAG$1,i.set(e,t);var u=equalArrays(s(e),s(t),r,n,o,i);return i.delete(e),u;case symbolTag$1:if(symbolValueOf)return symbolValueOf.call(e)==symbolValueOf.call(t)}return!1}var COMPARE_PARTIAL_FLAG$2=1,objectProto$a=Object.prototype,hasOwnProperty$7=objectProto$a.hasOwnProperty;function equalObjects(e,t,a,r,n,o){var i=a&COMPARE_PARTIAL_FLAG$2,s=getAllKeys(e),l=s.length;if(l!=getAllKeys(t).length&&!i)return!1;for(var c=l;c--;){var u=s[c];if(!(i?u in t:hasOwnProperty$7.call(t,u)))return!1}var d=o.get(e);if(d&&o.get(t))return d==t;var p=!0;o.set(e,t),o.set(t,e);for(var h=i;++c<l;){var f=e[u=s[c]],b=t[u];if(r)var g=i?r(b,f,u,t,e,o):r(f,b,u,e,t,o);if(!(void 0===g?f===b||n(f,b,a,r,o):g)){p=!1;break}h=h||"constructor"==u}if(p&&!h){var m=e.constructor,y=t.constructor;m!=y&&"constructor"in e&&"constructor"in t&&!("function"==typeof m&&m instanceof m&&"function"==typeof y&&y instanceof y)&&(p=!1)}return o.delete(e),o.delete(t),p}var COMPARE_PARTIAL_FLAG$3=1,argsTag$2="[object Arguments]",arrayTag$1="[object Array]",objectTag$2="[object Object]",objectProto$b=Object.prototype,hasOwnProperty$8=objectProto$b.hasOwnProperty;function baseIsEqualDeep(e,t,a,r,n,o){var i=isArray(e),s=isArray(t),l=i?arrayTag$1:getTag$1(e),c=s?arrayTag$1:getTag$1(t),u=(l=l==argsTag$2?objectTag$2:l)==objectTag$2,d=(c=c==argsTag$2?objectTag$2:c)==objectTag$2,p=l==c;if(p&&isBuffer(e)){if(!isBuffer(t))return!1;u=!(i=!0)}if(p&&!u)return o=o||new Stack,i||isTypedArray(e)?equalArrays(e,t,a,r,n,o):equalByTag(e,t,l,a,r,n,o);if(!(a&COMPARE_PARTIAL_FLAG$3)){var h=u&&hasOwnProperty$8.call(e,"__wrapped__"),f=d&&hasOwnProperty$8.call(t,"__wrapped__");if(h||f)return n(h?e.value():e,f?t.value():t,a,r,o=o||new Stack)}return p&&equalObjects(e,t,a,r,n,o=o||new Stack)}function baseIsEqual(e,t,a,r,n){return e===t||(null==e||null==t||!isObjectLike(e)&&!isObjectLike(t)?e!=e&&t!=t:baseIsEqualDeep(e,t,a,r,baseIsEqual,n))}var now=function(){return root.Date.now()},FUNC_ERROR_TEXT="Expected a function",nativeMax=Math.max,nativeMin=Math.min;function debounce(r,a,e){var n,o,i,s,l,c,u=0,d=!1,p=!1,t=!0;if("function"!=typeof r)throw new TypeError(FUNC_ERROR_TEXT);function h(e){var t=n,a=o;return n=o=void 0,u=e,s=r.apply(a,t)}function f(e){var t=e-c;return void 0===c||a<=t||t<0||p&&i<=e-u}function b(){var e=now();if(f(e))return g(e);l=setTimeout(b,function(e){var t=a-(e-c);return p?nativeMin(t,i-(e-u)):t}(e))}function g(e){return l=void 0,t&&n?h(e):(n=o=void 0,s)}function m(){var e=now(),t=f(e);if(n=arguments,o=this,c=e,t){if(void 0===l)return function(e){return u=e,l=setTimeout(b,a),d?h(e):s}(c);if(p)return clearTimeout(l),l=setTimeout(b,a),h(c)}return void 0===l&&(l=setTimeout(b,a)),s}return a=toNumber(a)||0,isObject(e)&&(d=!!e.leading,i=(p="maxWait"in e)?nativeMax(toNumber(e.maxWait)||0,a):i,t="trailing"in e?!!e.trailing:t),m.cancel=function(){void 0!==l&&clearTimeout(l),n=c=o=l=void(u=0)},m.flush=function(){return void 0===l?s:g(now())},m}var stringTag$2="[object String]";function isString(e){return"string"==typeof e||!isArray(e)&&isObjectLike(e)&&baseGetTag(e)==stringTag$2}function isEqual(e,t){return baseIsEqual(e,t)}var FUNC_ERROR_TEXT$1="Expected a function";function throttle(e,t,a){var r=!0,n=!0;if("function"!=typeof e)throw new TypeError(FUNC_ERROR_TEXT$1);return isObject(a)&&(r="leading"in a?!!a.leading:r,n="trailing"in a?!!a.trailing:n),debounce(e,t,{leading:r,maxWait:t,trailing:n})}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,a){return t&&_defineProperties(e.prototype,t),a&&_defineProperties(e,a),e}var PARENT_EVENT={SET_COPYABLE:"setCopyable",SET_CACHED_DATA:"setCachedData"},IFRAME_EVENT={FIRST_SCREEN_PAINTED:"firstScreenPainted",COPY_WITHOUT_PERMISSION:"copyWithoutPermission",CURRENT_TAB_CHANGED:"currentTabChanged",FETCH_ERROR:"fetchError"},tableContainerClass="table-container",tabContainerClass="tab-container",tableContainerMobileClass="tab-container--mobile",tableBoxCommonClass="table-box",tableBoxClassPrefix="table-box-",mainTableClass="main-table",firstRowWrapperClass="first-row-wrapper",firstRowClass="first-row",shadowTheadClass="shadow-thead",spinIndicatorClass="spin-indicator",firstColumnWrapperClass="first-column-wrapper",firstColumnClass="first-column",firstColumnFixedHeadClass="first-column__fixed-head",defaultRowHeight=24,firstRowHeight=24,rowMinHeight=20,tabContainerHeight=42,firstColumnBlockClass="first-column__block",perInsertDelay=500,defaultMountedBlockIndexs=[0,1,2],tabCommonClass="tab",activeTabClass="tab--active",outsideContainerClass="container",coordinateXAttributeName="data-x",coordinateYAttributeName="data-y",tabIndexAttributeName="data-index",noScrollbarClass="no-scrollbar",scrollTopTriggerInterval=100,innerCommentClassName="comment-indicator",maxCommentContentWidth=230,maxCommentContentHeight=160,newCommentContentClassName="comment-content",largeColumnCount=60,unpreviewableContainerClass="unpreviewable-container",FETCH_STATUS={UNINITIALIZED:0,FETCHING:1,SUCCESS:2,ERROR:3},notSupportedIcon='\n<svg width="120px" height="110px" viewBox="0 0 133 126" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">\n    \x3c!-- Generator: Sketch 52.4 (67378) - http://www.bohemiancoding.com/sketch --\x3e\n    <title>Group 7</title>\n    <desc>Created with Sketch.</desc>\n    <defs>\n        <polygon id="path-1" points="0 125.541126 132.623377 125.541126 132.623377 0.0917748918 0 0.0917748918"></polygon>\n    </defs>\n    <g id="Page-1" stroke="none" stroke-width="1" fill="none" fill-rule="evenodd">\n        <g id="文档详情页/无法预览" transform="translate(-629.000000, -316.000000)">\n            <g id="Group-7" transform="translate(616.000000, 298.000000)">\n                <rect id="Rectangle" fill-rule="nonzero" x="0" y="0" width="160" height="160"></rect>\n                <g id="Group-14" transform="translate(13.333333, 17.333333)">\n                    <polygon id="Fill-1" fill="#D6DAE1" points="0 106.807792 112.006926 106.807792 112.006926 15.2458874 0 15.2458874"></polygon>\n                    <polygon id="Fill-2" fill="#F4F5F9" points="96.0647619 38.4890909 86.2959307 101.374805 9.36779221 89.4250216 19.1366234 26.5384416"></polygon>\n                    <path d="M25.924329,82.8613853 L31.7762771,37.4163636" id="Stroke-3" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>\n                    <path d="M33.5609524,84.5582684 L39.4129004,39.1132468" id="Stroke-4" stroke="#FFFFFF" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"></path>\n                    <g id="Group-13" transform="translate(0.000000, 0.774026)">\n                        <path d="M132.255498,91.4894372 C129.310909,113.038355 109.454632,128.118874 87.9065801,125.17342 C66.3585281,122.228831 51.2771429,102.372554 54.2225974,80.825368 C57.1671861,59.2764502 77.0234632,44.1959307 98.5715152,47.1405195 C120.119567,50.085974 135.200087,69.9413853 132.255498,91.4894372" id="Fill-5" fill="#FFC200"></path>\n                        <g id="Clip-8"></g>\n                        <polygon id="Fill-7" fill="#B5BEC8" mask="url(#mask-2)" points="0 15.0995671 33.4779221 15.0995671 33.4779221 0.0917748918 0 0.0917748918"></polygon>\n                        <path d="M68.1769697,84.3922078 C68.1769697,84.3922078 92.9025108,107.81645 118.928485,84.3922078" id="Stroke-9" stroke="#18263C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" mask="url(#mask-2)"></path>\n                        <path d="M77.9370563,91.5494372 L73.3820779,100.008312" id="Stroke-10" stroke="#18263C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" mask="url(#mask-2)"></path>\n                        <path d="M93.5528139,95.4531602 L93.5528139,105.86355" id="Stroke-11" stroke="#18263C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" mask="url(#mask-2)"></path>\n                        <path d="M108.517403,92.2004329 L115.023896,99.3580087" id="Stroke-12" stroke="#18263C" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" mask="url(#mask-2)"></path>\n                    </g>\n                </g>\n            </g>\n        </g>\n    </g>\n</svg>';function sendMessage(e,t){parent.postMessage({key:e,value:t},"*")}function toggleSpinVisible(e){var t=document.querySelector(".".concat(spinIndicatorClass));t&&(t.style.display=e?"block":"none")}function setSecLink(e){if(e)for(var t=e.getElementsByTagName("a"),a=0;a<t.length;a++){var r=t[a];isAnchorUrl(r)||r.className.includes(innerCommentClassName)||(r.href=getCustomSecureLink(r),r.setAttribute("target","_blank"))}}function getAlphaNumericExcelCoordinates(e){var t="A".charCodeAt(0),a="";e+=1;do{var r=(e-=1)%26;a=String.fromCharCode(t+r)+a,e-=r,e/=26,e=Math.round(e)}while(0<e);return a}function generateFirstColumnBlockHTMLText(e){return e.reduce(function(e,t){return"".concat(e,"<span ").concat(coordinateYAttributeName,"=").concat(t.rowIndex,' style="height:').concat(t.height,'px;">').concat(t.rowIndex+1,"</span>")},"")}function getIsInitialNeededBlock(e){return 0<=e&&e<=2}function getSubordinativeTDElement(e){if(!e)return null;for(;e;){if("TD"===e.tagName)return e;e=e.parentElement}return null}function getPerBlockRowsLengthBySreenHeight(){var e=window.screen&&window.screen.availHeight?window.screen.availHeight:window.innerHeight;return Math.round(e/rowMinHeight/2.5)||30}function postFetchErrorMessageIfNecessary(e,t){400<=e&&sendMessage(IFRAME_EVENT.FETCH_ERROR,{status:e,subId:t})}function isSuccessHTTPCode(e){return 200<=e&&e<300||304===e}var SheetService=function(){function i(e){_classCallCheck(this,i);var t=e.index,a=e.tableContainerElement,r=e.getGlobalState,n=e.handleInitialLoaded,o=e.size;this.isMobile=r().isMobile,this.index=t,this.size=o||0,this.tableContainerElement=a,this.tableBoxElement=this.createTableBox(a),this.getGlobalState=r,this.handleInitialLoaded=n,this.scrollTopBeforeUnmount=0,this.scrollLeftBeforeUnmount=0,this.dataFetchStatus=FETCH_STATUS.UNINITIALIZED,this.wholeRowsCount=0,this.wholeColumnCount=0,this.tempTableRawData="",this.blocksData=[],this.firstRowWrapperElement=null,this.firstRowElement=null,this.firstColumnElement=null,this.tableElement=null,this.unParsedTrList=[],this.mountedBlockIndexs=defaultMountedBlockIndexs.slice(),this.firstScreenPainted=!1,this.defaultPerBlockRowsLength=r().perBlockRowsLength}return _createClass(i,[{key:"createTableBox",value:function(e){var t=document.createElement("div");return t.className="".concat(tableBoxCommonClass," ").concat(tableBoxClassPrefix).concat(this.index),t.style.display="none",e.appendChild(t),t}},{key:"mountTable",value:function(){toggleSpinVisible(this.dataFetchStatus===FETCH_STATUS.FETCHING),this.tableBoxElement.style.display="block",this.tableContainerElement.scrollTop=this.scrollTopBeforeUnmount,this.tableContainerElement.scrollLeft=this.scrollLeftBeforeUnmount,this.setFirstRowWrapperWidth(),this.scrollTopBeforeUnmount||this.renderBlocksByScrollTop(0,!0),sendMessage(IFRAME_EVENT.CURRENT_TAB_CHANGED,{index:this.index}),window.jsObj&&window.jsObj.currentTabChanged&&window.jsObj.currentTabChanged(String(this.index)),this.size>=this.getGlobalState().perTabMaxSize?this.handleTableSizeExceeded():this.fetchTableDataIfNecessary()}},{key:"unmountTable",value:function(){this.scrollTopBeforeUnmount=this.tableContainerElement.scrollTop,this.scrollLeftBeforeUnmount=this.tableContainerElement.scrollLeft,this.tableBoxElement.style.display="none",this.recoverTableContainerSize()}},{key:"handleTableSizeExceeded",value:function(){this.setTableContainerExpandedSize(),this.tableBoxElement.innerHTML="<div class=".concat(unpreviewableContainerClass,">").concat(notSupportedIcon,"<span>").concat(this.getGlobalState().sizeExceededTipsText,"</span></div>"),this.handleInitialLoaded()}},{key:"setTableContainerExpandedSize",value:function(){this.tableContainerElement.style.width="100%",this.tableContainerElement.style.left="0"}},{key:"recoverTableContainerSize",value:function(){this.tableContainerElement.style.width="",this.tableContainerElement.style.left=""}},{key:"fetchTableDataIfNecessary",value:function(){this.dataFetchStatus!==FETCH_STATUS.UNINITIALIZED&&this.dataFetchStatus!==FETCH_STATUS.ERROR||(toggleSpinVisible(!0),this.getTableData())}},{key:"getTableData",value:function(){this.dataFetchStatus=FETCH_STATUS.FETCHING,window.jsObj&&window.jsObj.requestCachedData?window.jsObj.requestCachedData(String(this.index)):this.fetchTableData()}},{key:"fetchTableData",value:function(){var e=this,t=String(this.index),a=this.getGlobalState().apiPrefix,r=new XMLHttpRequest,n="".concat(a,"&sub_id=").concat(t);r.open("GET",n),r.withCredentials=!0,r.onreadystatechange=function(){4===r.readyState&&(postFetchErrorMessageIfNecessary(r.status,t),e.isActive&&toggleSpinVisible(!1),isSuccessHTTPCode(r.status)?e.handleDataFetched(r.response):e.dataFetchStatus=FETCH_STATUS.ERROR)},r.send()}},{key:"handleDataFetched",value:function(e){this.isActive&&toggleSpinVisible(!1),this.dataFetchStatus!==FETCH_STATUS.SUCCESS&&(this.dataFetchStatus=FETCH_STATUS.SUCCESS,this.transformRawData(e))}},{key:"handleSubDataFetched",value:function(e,t){this.tempTableRawData+=e,t||(this.handleDataFetched(this.tempTableRawData),this.tempTableRawData="")}},{key:"transformRawData",value:function(e){var t=this,a=(new DOMParser).parseFromString(e,"text/html").querySelector("table");if(a){setSecLink(a);var r=a.querySelectorAll("tr"),n=a.querySelectorAll("colgroup"),o=Array.prototype.slice.call(r);this.unParsedTrList=o;var i=this.traverseColgroups(n),s=i.theadOuterHTML,l=i.firstRowInnerHTML,c=i.colCount;this.wholeRowsCount=o.length,this.wholeColumnCount=c,this.createHiddenFirstRow(l),this.createFirstColumn(),a.className=mainTableClass,a.innerHTML=s,this.tableElement=a,this.tableBoxElement.appendChild(a),this.handleInitialLoaded(),setTimeout(function(){t.generateInitialBlockData(0)},0)}}},{key:"traverseColgroups",value:function(e){for(var t="<thead class=".concat(shadowTheadClass,"><tr>"),a="",r=0,n=0,o=0;o<e.length;o++){var i=e[o],s=i.span||1,l=Number(i.width);if(r+=s,1<s){for(var c=n+s,u=n;u<c;u++)t+='<th width="'.concat(l,'" style="width:').concat(l,"px;min-width:").concat(l,"px;max-width:").concat(l,'px;">1</th>'),a+="<span ".concat(coordinateXAttributeName,"=").concat(u,' style="width:').concat(l,'px;">').concat(getAlphaNumericExcelCoordinates(u),"</span>");n+=s}else t+='<th width="'.concat(l,'" style="width:').concat(l,"px;min-width:").concat(l,"px;max-width:").concat(l,'px;">1</th>'),a+="<span ".concat(coordinateXAttributeName,"=").concat(n,' style="width:').concat(l,'px;">').concat(getAlphaNumericExcelCoordinates(n),"</span>"),n+=1}return{theadOuterHTML:t+="</tr></thead>",firstRowInnerHTML:a,colCount:r}}},{key:"createHiddenFirstRow",value:function(e){var t=document.createElement("div");t.className=firstRowWrapperClass;var a=document.createElement("div");if(a.className=firstRowClass,a.innerHTML=e,this.firstRowElement=a,(this.firstRowWrapperElement=t).style.visibility="hidden",this.isMobile){var r=this.getGlobalState().tabContainerHeight;t.style.top="".concat(r,"px")}t.appendChild(a),this.tableBoxElement.appendChild(t)}},{key:"createFirstColumn",value:function(){var e=document.createElement("div");e.className=firstColumnWrapperClass;var t=document.createElement("div");t.className=firstColumnClass;var a=document.createElement("div");if(a.className=firstColumnFixedHeadClass,this.isMobile){var r=this.getGlobalState().tabContainerHeight;a.style.top="".concat(r,"px"),e.style.top="".concat(r,"px")}e.appendChild(a),e.appendChild(t),this.firstColumnElement=t,this.tableBoxElement.appendChild(e)}},{key:"generateInitialBlockData",value:function(e){var t=this,a=this.unParsedTrList.length,r=this.getHTMLTextByRows().HTMLText,n=a-this.unParsedTrList.length,o=document.createElement("tbody");o.setAttribute("index",e),o.innerHTML=r,this.tableElement.appendChild(o);var i=this.traverseRows(o),s=i.blockHeight,l=i.rowsData,c=i.tbodyInnerHTML,u=document.createElement("div");u.className=firstColumnBlockClass,u.setAttribute("index",e),u.innerHTML=generateFirstColumnBlockHTMLText(l),this.firstColumnElement.appendChild(u);var d=n*defaultRowHeight,p=0===s?d:s,h=this.blocksData[e-1]?this.blocksData[e-1].offsetBottom:0,f=h+p;this.blocksData[e]={rowsLength:n,height:p,offsetTop:h,offsetBottom:f,HTMLText:c,placeholderHeight:d,realHeight:s,rowsData:l},this.setFirstRowWrapperWidth(),this.showFirstRow();var b=!getIsInitialNeededBlock(e+1)||0===this.unParsedTrList.length;setTimeout(function(){b?(t.fillRestBlocks(e),t.completeInitBlockData()):t.generateInitialBlockData(e+1)},perInsertDelay)}},{key:"traverseRows",value:function(e){var t=0,a=[],r="";if(e){for(var n=0<e.offsetHeight&&this.getGlobalState().styleInjected,o=e.querySelectorAll("tr"),i=0;i<o.length;i++){var s=o[i],l=Number(s.getAttribute(coordinateYAttributeName)),c=n?Math.max(rowMinHeight,s.getBoundingClientRect().height)||defaultRowHeight:0;s.style.height="".concat(c,"px"),t+=c,a.push({rowIndex:l,height:c})}r=e.innerHTML}return{blockHeight:t,rowsData:a,tbodyInnerHTML:r}}},{key:"getHTMLTextByRows",value:function(e,t,a){for(var r=0<arguments.length&&void 0!==e?e:this.defaultPerBlockRowsLength,n=1<arguments.length&&void 0!==t?t:0,o=2<arguments.length&&void 0!==a?a:[],i=this.wholeRowsCount-this.unParsedTrList.length,s=this.unParsedTrList.splice(0,r),l="",c=[],u=0,d=0;d<s.length;d++){var p=s[d],h=i+d,f=n+d;p.setAttribute(coordinateYAttributeName,h);for(var b=p.querySelectorAll("td"),g=0;g<b.length;g++){for(var m=b[g],y=m.rowSpan||1,T=m.colSpan||1,v=g;o[f]&&o[f][v];v++);m.setAttribute(coordinateXAttributeName,v),m.setAttribute(coordinateYAttributeName,h);for(var C=v;C<v+T;C++)for(var E=f;E<f+y;E++)o[E]||(o[E]=[]),o[E][C]=!0;if(1<y){var w=d+y-s.length;u=Math.max(u,w)}}l+=p.outerHTML,c.push({rowIndex:h,height:defaultRowHeight})}if(0<u){n+=s.length;var S=this.getHTMLTextByRows(u,n,o);l+=S.HTMLText,c=c.concat(S.initialRowsData)}return{HTMLText:l,initialRowsData:c}}},{key:"showFirstRow",value:function(){this.firstRowWrapperElement&&(this.firstRowWrapperElement.style.visibility="visible")}},{key:"setFirstRowWrapperWidth",value:function(){this.firstRowWrapperElement&&this.tableBoxElement&&(this.firstRowWrapperElement.style.width="".concat(this.tableBoxElement.offsetWidth,"px"))}},{key:"fillRestBlocks",value:function(e){for(var t=e;0<this.unParsedTrList.length;){t+=1;var a=this.unParsedTrList.length,r=this.getHTMLTextByRows(),n=r.HTMLText,o=r.initialRowsData,i=a-this.unParsedTrList.length,s=this.blocksData[t-1]?this.blocksData[t-1].offsetBottom:0,l=i*defaultRowHeight,c=s+l;this.blocksData[t]={rowsLength:i,height:l,offsetTop:s,offsetBottom:c,HTMLText:n,placeholderHeight:l,realHeight:0,rowsData:o}}}},{key:"completeInitBlockData",value:function(){this.firstScreenPainted=!0,this.isActive&&this.renderBlocksByScrollTop(this.tableContainerElement.scrollTop,!0)}},{key:"setVirtualListPadding",value:function(){var e=this.mountedBlockIndexs,t=this.blocksData,a=e[0],r=e[e.length-1],n=t[t.length-1].offsetBottom,o=t[a]?t[a].offsetTop:0,i=t[r]?n-t[r].offsetBottom:0;this.tableElement.style.paddingTop="".concat(o,"px"),this.tableElement.style.paddingBottom="".concat(i,"px"),this.firstColumnElement.style.paddingTop="".concat(o+firstRowHeight,"px"),this.firstColumnElement.style.paddingBottom="".concat(i,"px")}},{key:"setFirstColumnTop",value:function(e){this.firstColumnElement&&(this.firstColumnElement.style.transform="translate3d(0, ".concat(-e,"px, 0)"),this.firstColumnElement.style.webkitTransform="translate3d(0, ".concat(-e,"px, 0)"))}},{key:"setFirstRowLeft",value:function(e){this.firstRowElement&&(this.firstRowElement.style.transform="translate3d(".concat(-e,"px, 0, 0)"),this.firstRowElement.style.webkitTransform="translate3d(".concat(-e,"px, 0, 0)"))}},{key:"renderBlocksByScrollTop",value:function(e,u){var d=this;if(this.firstScreenPainted){var p=this.blocksData;if(u||!(p.length<=3)){var t=this.mountedBlockIndexs.slice();this.setMountedBlockIndexs(e);var h=this.mountedBlockIndexs;if(u||!isEqual(t,h)){var f=this.tableElement.querySelectorAll("tbody"),b=this.firstColumnElement.querySelectorAll(".".concat(firstColumnBlockClass)),g=-1;p.forEach(function(e,t){if(h.includes(t)){var a=f[g+=1],r=b[g];if(a.innerHTML=e.HTMLText,a.setAttribute("index",t),u||!e.realHeight){var n=d.traverseRows(a),o=n.blockHeight,i=n.rowsData,s=n.tbodyInnerHTML;e.realHeight=o,e.rowsData=i,e.HTMLText=s}r.innerHTML=generateFirstColumnBlockHTMLText(e.rowsData),e.height=e.realHeight}var l=p[t-1]?p[t-1].offsetBottom:0,c=l+e.height;e.offsetTop=l,e.offsetBottom=c}),this.setVirtualListPadding(),this.isMobile&&u&&this.ensureFirstRowItemWidth()}}}}},{key:"setMountedBlockIndexs",value:function(e){for(var t=this.blocksData.length,a=0;a<t;a++){var r=this.blocksData[a];if(r&&e>=r.offsetTop&&e<r.offsetBottom){var n=(r.offsetTop+r.offsetBottom)/3<e?a+1:a,o=[];o=n-1<=0?defaultMountedBlockIndexs.slice():t<=n+1?[t-3,t-2,t-1]:[n-1,n,n+1],this.mountedBlockIndexs=o;break}}}},{key:"ensureFirstRowItemWidth",value:function(){if(this.firstRowWrapperElement&&this.tableElement)for(var e=this.firstRowWrapperElement.querySelectorAll("span"),t=this.tableElement.querySelectorAll("th"),a=0;a<t.length;a++)if(e[a]){var r=t[a].getBoundingClientRect().width;r&&(e[a].style.width="".concat(r,"px"))}}},{key:"isActive",get:function(){return this.getGlobalState().currentTabIndex===this.index}}]),i}();!function(){var e=window.initialData||{},t=e.initTabIndex,a=e.apiPrefix,r=e.tabList,n=e.isMobile,o=e.copyable,i=e.perTabMaxSize,s=e.sizeExceededTipsText,l=e.sizeList,c={SheetServiceList:[],hasInitialLoaded:!1,copyable:o,currentTabIndex:t||0,apiPrefix:a||"",tabList:r||[],isMobile:n,currentDevicePixelRatio:window.devicePixelRatio,tabContainerHeight:0,lastTriggerScrollTopList:[],newCommentElement:null,perBlockRowsLength:getPerBlockRowsLengthBySreenHeight(),styleInjected:!1,remainRerenderCount:5,perTabMaxSize:i,sizeExceededTipsText:s,sizeList:l||[],tempStyleData:""};function u(){window.jsObj&&window.jsObj.requestCachedData?window.jsObj.requestCachedData("style"):function(){var e=new XMLHttpRequest,t="".concat(c.apiPrefix,"&sub_id=").concat("style");e.open("GET",t),e.withCredentials=!0,e.onreadystatechange=function(){4===e.readyState&&(postFetchErrorMessageIfNecessary(e.status,"style"),isSuccessHTTPCode(e.status)&&d(e.response))},e.send()}()}function d(e){var t=document.createElement("style");t.textContent=e,document.head.append(t),c.styleInjected=!0,function e(){c.remainRerenderCount-=1;if(c.remainRerenderCount<=0)return;var t=document.querySelector(".".concat(tableContainerClass));var a=t&&t.scrollTop?t.scrollTop:0;var r=c.SheetServiceList,n=c.currentTabIndex;r[n]&&r[n].renderBlocksByScrollTop(a,!0);setTimeout(function(){e()},2e3)}()}function p(e){var t=Number(e.currentTarget.getAttribute(tabIndexAttributeName));c.currentTabIndex!==t&&h(t)}function h(e){var t=c.currentTabIndex,a=document.querySelectorAll(".".concat(tabCommonClass)),r=a[t],n=a[e];!function(e,t){c.SheetServiceList[t].unmountTable(),e&&e.classList.remove(activeTabClass)}(r,t),function(e,t){c.SheetServiceList[t].mountTable(),e&&e.classList.add(activeTabClass);c.currentTabIndex=t}(n,e)}function f(e,t){var a=Math.max(0,t),r=c.SheetServiceList,n=c.lastTriggerScrollTopList,o=n[e]||0;!r[e]||Math.abs(a-o)<scrollTopTriggerInterval||(r[e].renderBlocksByScrollTop(a),n[e]=a)}function b(){c.hasInitialLoaded||(c.hasInitialLoaded=!0,sendMessage(IFRAME_EVENT.FIRST_SCREEN_PAINTED),window.jsObj&&window.jsObj.firstScreenPainted&&window.jsObj.firstScreenPainted())}function g(e){var t=e.data;if(isObject(t))switch(t.key){case PARENT_EVENT.SET_COPYABLE:c.copyable=t.value;break;case PARENT_EVENT.SET_CACHED_DATA:!function(e){if(!e||!e.subId)return;var t=e.subId,a=e.data,r=e.hasMore;if("style"===t)return function(e,t){c.tempStyleData+=e,t||(d(c.tempStyleData),c.tempStyleData="")}(a,r);var n=c.SheetServiceList[Number(t)];if(!n)return;n.handleSubDataFetched(a,r)}(t.value)}}function m(e){c.copyable||(e.preventDefault(),sendMessage(IFRAME_EVENT.COPY_WITHOUT_PERMISSION),window.jsObj&&window.jsObj.copyWithoutPermission&&window.jsObj.copyWithoutPermission())}function y(e){c.copyable||e.preventDefault()}var T=debounce(f,150,{trailing:!0,leading:!1}),v=throttle(f,300,{trailing:!0,leading:!0});function C(e){var t=c.currentTabIndex,a=c.SheetServiceList,r=c.isMobile,n=e.target.scrollTop,o=e.target.scrollLeft,i=a[t];i.setFirstColumnTop(n),i.setFirstRowLeft(o),r&&i.wholeColumnCount>largeColumnCount?T(t,n):v(t,n),r&&E()}function E(){var e=c.newCommentElement;e&&"block"===e.style.display&&(e.style.display="none")}var w,S,_,x,k=throttle(function(e){if(e&&e.target&&isString(e.target.className)&&e.target.className.includes(innerCommentClassName)){var t=getSubordinativeTDElement(e.target);if(!t)return;var a=t.querySelector("comment");if(!a)return;if(!c.newCommentElement){var r=document.createElement("div");r.className=newCommentContentClassName,document.body.appendChild(r),c.newCommentElement=r}var n=c.newCommentElement;if("block"===n.style.display)return;var o=a.innerHTML,i=e.clientX>window.innerWidth-maxCommentContentWidth,s=e.clientY>window.innerHeight-maxCommentContentHeight;n.style.right=i?"".concat(window.innerWidth-e.clientX,"px"):"auto",n.style.left=i?"auto":"".concat(e.clientX,"px"),n.style.bottom=s?"".concat(window.innerHeight-e.clientY,"px"):"auto",n.style.top=s?"auto":"".concat(e.clientY,"px"),n.innerHTML=o,n.style.display="block"}else E()},300,{trailing:!0,leading:!0});function A(){I(),function(){var e=c.SheetServiceList,t=c.currentTabIndex;e[t].setFirstRowWrapperWidth()}()}function I(){var e=document.querySelector(".".concat(tableContainerClass));if(e){var t=window.innerHeight-c.tabContainerHeight;e.style.height="".concat(t,"px")}}function L(){return c}_=c.currentTabIndex,x=c.isMobile,u(),function(){window.addEventListener("resize",A),window.addEventListener("message",g),document.addEventListener("copy",m),document.addEventListener("contextmenu",y);var e=document.querySelector(".".concat(tableContainerClass));e.addEventListener("scroll",C),e.addEventListener("mousemove",k)}(),function(){for(var e=c.tabList,t=c.SheetServiceList,a=c.sizeList,r=document.querySelector(".".concat(tableContainerClass)),n=e&&0<e.length?e.length:1,o=0;o<n;o++){var i=new SheetService({index:o,tableContainerElement:r,getGlobalState:L,handleInitialLoaded:b,size:a[o]});t[o]=i}}(),function(){var e=c.tabList,r=c.currentTabIndex;if(e&&0<e.length){var t=document.querySelector(".".concat(outsideContainerClass)),n=document.createElement("div");n.className=tabContainerClass,e.forEach(function(e,t){var a=document.createElement("div");a.className=t===r?"".concat(tabCommonClass," ").concat(activeTabClass):tabCommonClass,a.setAttribute(tabIndexAttributeName,t),a.innerText=e,a.onclick=p,n.appendChild(a)}),t.appendChild(n),c.tabContainerHeight=tabContainerHeight}}(),h(_),x&&(w=document.querySelector(".".concat(tableContainerClass)),(S=document.querySelector(".".concat(tabContainerClass)))&&(S.classList.add(tableContainerMobileClass),S.classList.add(noScrollbarClass)),w&&(w.style.top="".concat(c.tabContainerHeight,"px"))),I(),seclinkReportInit()}();
