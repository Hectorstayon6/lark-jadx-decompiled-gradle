parcelRequire=function(e,r,t,n){var i,o="function"==typeof parcelRequire&&parcelRequire,u="function"==typeof require&&require;function f(t,n){if(!r[t]){if(!e[t]){var i="function"==typeof parcelRequire&&parcelRequire;if(!n&&i)return i(t,!0);if(o)return o(t,!0);if(u&&"string"==typeof t)return u(t);var c=new Error("Cannot find module '"+t+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[t][1][r]||r},p.cache={};var l=r[t]=new f.Module(t);e[t][0].call(l.exports,p,l,l.exports,this)}return r[t].exports;function p(e){return f(p.resolve(e))}}f.isParcelRequire=!0,f.Module=function(e){this.id=e,this.bundle=f,this.exports={}},f.modules=e,f.cache=r,f.parent=o,f.register=function(r,t){e[r]=[function(e,r){r.exports=t},{}]};for(var c=0;c<t.length;c++)try{f(t[c])}catch(e){i||(i=e)}if(t.length){var l=f(t[t.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=l:"function"==typeof define&&define.amd?define(function(){return l}):n&&(this[n]=l)}if(parcelRequire=f,i)throw i;return f}({"pBGv":[function(require,module,exports) {

var t,e,n=module.exports={};function r(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function i(e){if(t===setTimeout)return setTimeout(e,0);if((t===r||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}function u(t){if(e===clearTimeout)return clearTimeout(t);if((e===o||!e)&&clearTimeout)return e=clearTimeout,clearTimeout(t);try{return e(t)}catch(n){try{return e.call(null,t)}catch(n){return e.call(this,t)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:r}catch(n){t=r}try{e="function"==typeof clearTimeout?clearTimeout:o}catch(n){e=o}}();var c,s=[],l=!1,a=-1;function f(){l&&c&&(l=!1,c.length?s=c.concat(s):a=-1,s.length&&h())}function h(){if(!l){var t=i(f);l=!0;for(var e=s.length;e;){for(c=s,s=[];++a<e;)c&&c[a].run();a=-1,e=s.length}c=null,l=!1,u(t)}}function m(t,e){this.fun=t,this.array=e}function p(){}n.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];s.push(new m(t,e)),1!==s.length||l||i(h)},m.prototype.run=function(){this.fun.apply(null,this.array)},n.title="browser",n.env={},n.argv=[],n.version="",n.versions={},n.on=p,n.addListener=p,n.once=p,n.off=p,n.removeListener=p,n.removeAllListeners=p,n.emit=p,n.prependListener=p,n.prependOnceListener=p,n.listeners=function(t){return[]},n.binding=function(t){throw new Error("process.binding is not supported")},n.cwd=function(){return"/"},n.chdir=function(t){throw new Error("process.chdir is not supported")},n.umask=function(){return 0};
},{}],"vFlK":[function(require,module,exports) {
var define;
var global = arguments[3];
var process = require("process");
var t,n=arguments[3],e=require("process");!function(n){"use strict";if("function"==typeof bootstrap)bootstrap("promise",n);else if("object"==typeof exports&&"object"==typeof module)module.exports=n();else if("function"==typeof t&&t.amd)t(n);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=n}else{if("undefined"==typeof window&&"undefined"==typeof self)throw new Error("This environment was not anticipated by Q. Please file a bug.");var e="undefined"!=typeof window?window:self,r=e.Q;e.Q=n(),e.Q.noConflict=function(){return e.Q=r,this}}}(function(){"use strict";var t=!1;try{throw new Error}catch(K){t=!!K.stack}var n,r=b(),o=function(){},i=function(){var t={task:void 0,next:null},n=t,r=!1,o=void 0,u=!1,c=[];function f(){for(var n,e;t.next;)n=(t=t.next).task,t.task=void 0,(e=t.domain)&&(t.domain=void 0,e.enter()),p(n,e);for(;c.length;)p(n=c.pop());r=!1}function p(t,n){try{t()}catch(K){if(u)throw n&&n.exit(),setTimeout(f,0),n&&n.enter(),K;setTimeout(function(){throw K},0)}n&&n.exit()}if(i=function(t){n=n.next={task:t,domain:u&&e.domain,next:null},r||(r=!0,o())},"object"==typeof e&&"[object process]"===e.toString()&&e.nextTick)u=!0,o=function(){e.nextTick(f)};else if("function"==typeof setImmediate)o="undefined"!=typeof window?setImmediate.bind(window,f):function(){setImmediate(f)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){o=a,s.port1.onmessage=f,f()};var a=function(){s.port2.postMessage(0)};o=function(){setTimeout(f,0),a()}}else o=function(){setTimeout(f,0)};return i.runAfter=function(t){c.push(t),r||(r=!0,o())},i}(),u=Function.call;function c(t){return function(){return u.apply(t,arguments)}}var f,p=c(Array.prototype.slice),s=c(Array.prototype.reduce||function(t,n){var e=0,r=this.length;if(1===arguments.length)for(;;){if(e in this){n=this[e++];break}if(++e>=r)throw new TypeError}for(;e<r;e++)e in this&&(n=t(n,this[e],e));return n}),a=c(Array.prototype.indexOf||function(t){for(var n=0;n<this.length;n++)if(this[n]===t)return n;return-1}),l=c(Array.prototype.map||function(t,n){var e=this,r=[];return s(e,function(o,i,u){r.push(t.call(n,i,u,e))},void 0),r}),d=Object.create||function(t){function n(){}return n.prototype=t,new n},h=Object.defineProperty||function(t,n,e){return t[n]=e.value,t},y=c(Object.prototype.hasOwnProperty),v=Object.keys||function(t){var n=[];for(var e in t)y(t,e)&&n.push(e);return n},m=c(Object.prototype.toString);f="undefined"!=typeof ReturnValue?ReturnValue:function(t){this.value=t};var k="From previous event:";function w(n,e){if(t&&e.stack&&"object"==typeof n&&null!==n&&n.stack){for(var r=[],o=e;o;o=o.source)o.stack&&(!n.__minimumStackCounter__||n.__minimumStackCounter__>o.stackCounter)&&(h(n,"__minimumStackCounter__",{value:o.stackCounter,configurable:!0}),r.unshift(o.stack));r.unshift(n.stack);var i=function(t){for(var n=t.split("\n"),e=[],r=0;r<n.length;++r){var o=n[r];!g(o)&&(-1===(i=o).indexOf("(module.js:")&&-1===i.indexOf("(node.js:"))&&o&&e.push(o)}var i;return e.join("\n")}(r.join("\n"+k+"\n"));h(n,"stack",{value:i,configurable:!0})}}function j(t){var n=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(t);if(n)return[n[1],Number(n[2])];var e=/at ([^ ]+):(\d+):(?:\d+)$/.exec(t);if(e)return[e[1],Number(e[2])];var r=/.*@(.+):(\d+)$/.exec(t);return r?[r[1],Number(r[2])]:void 0}function g(t){var e=j(t);if(!e)return!1;var o=e[0],i=e[1];return o===n&&i>=r&&i<=J}function b(){if(t)try{throw new Error}catch(K){var e=K.stack.split("\n"),r=j(e[0].indexOf("@")>0?e[1]:e[2]);if(!r)return;return n=r[0],r[1]}}function x(t){return t instanceof O?t:N(t)?(n=t,e=R(),x.nextTick(function(){try{n.then(e.resolve,e.reject,e.notify)}catch(t){e.reject(t)}}),e.promise):V(t);var n,e}x.resolve=x,x.nextTick=i,x.longStackSupport=!1;var T=1;function R(){var n,e=[],r=[],o=d(R.prototype),i=d(O.prototype);if(i.promiseDispatch=function(t,o,i){var u=p(arguments);e?(e.push(u),"when"===o&&i[1]&&r.push(i[1])):x.nextTick(function(){n.promiseDispatch.apply(n,u)})},i.valueOf=function(){if(e)return i;var t=Q(n);return _(t)&&(n=t),t},i.inspect=function(){return n?n.inspect():{state:"pending"}},x.longStackSupport&&t)try{throw new Error}catch(K){i.stack=K.stack.substring(K.stack.indexOf("\n")+1),i.stackCounter=T++}function u(o){n=o,x.longStackSupport&&t&&(i.source=o),s(e,function(t,n){x.nextTick(function(){o.promiseDispatch.apply(o,n)})},void 0),e=void 0,r=void 0}return o.promise=i,o.resolve=function(t){n||u(x(t))},o.fulfill=function(t){n||u(V(t))},o.reject=function(t){n||u(B(t))},o.notify=function(t){n||s(r,function(n,e){x.nextTick(function(){e(t)})},void 0)},o}function S(t){if("function"!=typeof t)throw new TypeError("resolver must be a function.");var n=R();try{t(n.resolve,n.reject,n.notify)}catch(e){n.reject(e)}return n.promise}function E(t){return S(function(n,e){for(var r=0,o=t.length;r<o;r++)x(t[r]).then(n,e)})}function O(t,n,e){void 0===n&&(n=function(t){return B(new Error("Promise does not support operation: "+t))}),void 0===e&&(e=function(){return{state:"unknown"}});var r=d(O.prototype);if(r.promiseDispatch=function(e,o,i){var u;try{u=t[o]?t[o].apply(r,i):n.call(r,o,i)}catch(c){u=B(c)}e&&e(u)},r.inspect=e,e){var o=e();"rejected"===o.state&&(r.exception=o.reason),r.valueOf=function(){var t=e();return"pending"===t.state||"rejected"===t.state?r:t.value}}return r}function C(t,n,e,r){return x(t).then(n,e,r)}function Q(t){if(_(t)){var n=t.inspect();if("fulfilled"===n.state)return n.value}return t}function _(t){return t instanceof O}function N(t){return(n=t)===Object(n)&&"function"==typeof t.then;var n}"object"==typeof e&&e&&e.env,x.defer=R,R.prototype.makeNodeResolver=function(){var t=this;return function(n,e){n?t.reject(n):arguments.length>2?t.resolve(p(arguments,1)):t.resolve(e)}},x.Promise=S,x.promise=S,S.race=E,S.all=L,S.reject=B,S.resolve=x,x.passByCopy=function(t){return t},O.prototype.passByCopy=function(){return this},x.join=function(t,n){return x(t).join(n)},O.prototype.join=function(t){return x([this,t]).spread(function(t,n){if(t===n)return t;throw new Error("Q can't join: not the same: "+t+" "+n)})},x.race=E,O.prototype.race=function(){return this.then(x.race)},x.makePromise=O,O.prototype.toString=function(){return"[object Promise]"},O.prototype.then=function(t,n,e){var r=this,o=R(),i=!1;return x.nextTick(function(){r.promiseDispatch(function(n){i||(i=!0,o.resolve(function(n){try{return"function"==typeof t?t(n):n}catch(e){return B(e)}}(n)))},"when",[function(t){i||(i=!0,o.resolve(function(t){if("function"==typeof n){w(t,r);try{return n(t)}catch(e){return B(e)}}return B(t)}(t)))}])}),r.promiseDispatch(void 0,"when",[void 0,function(t){var n,r=!1;try{n=function(t){return"function"==typeof e?e(t):t}(t)}catch(K){if(r=!0,!x.onerror)throw K;x.onerror(K)}r||o.notify(n)}]),o.promise},x.tap=function(t,n){return x(t).tap(n)},O.prototype.tap=function(t){return t=x(t),this.then(function(n){return t.fcall(n).thenResolve(n)})},x.when=C,O.prototype.thenResolve=function(t){return this.then(function(){return t})},x.thenResolve=function(t,n){return x(t).thenResolve(n)},O.prototype.thenReject=function(t){return this.then(function(){throw t})},x.thenReject=function(t,n){return x(t).thenReject(n)},x.nearer=Q,x.isPromise=_,x.isPromiseAlike=N,x.isPending=function(t){return _(t)&&"pending"===t.inspect().state},O.prototype.isPending=function(){return"pending"===this.inspect().state},x.isFulfilled=function(t){return!_(t)||"fulfilled"===t.inspect().state},O.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},x.isRejected=function(t){return _(t)&&"rejected"===t.inspect().state},O.prototype.isRejected=function(){return"rejected"===this.inspect().state};var P,D,A,I=[],F=[],M=[],U=!0;function $(){I.length=0,F.length=0,U||(U=!0)}function B(t){var n=O({when:function(n){return n&&function(t){if(U){var n=a(F,t);-1!==n&&("object"==typeof e&&"function"==typeof e.emit&&x.nextTick.runAfter(function(){var r=a(M,t);-1!==r&&(e.emit("rejectionHandled",I[n],t),M.splice(r,1))}),F.splice(n,1),I.splice(n,1))}}(this),n?n(t):this}},function(){return this},function(){return{state:"rejected",reason:t}});return function(t,n){U&&("object"==typeof e&&"function"==typeof e.emit&&x.nextTick.runAfter(function(){-1!==a(F,t)&&(e.emit("unhandledRejection",n,t),M.push(t))}),F.push(t),n&&void 0!==n.stack?I.push(n.stack):I.push("(no stack) "+n))}(n,t),n}function V(t){return O({when:function(){return t},get:function(n){return t[n]},set:function(n,e){t[n]=e},delete:function(n){delete t[n]},post:function(n,e){return null==n?t.apply(void 0,e):t[n].apply(t,e)},apply:function(n,e){return t.apply(n,e)},keys:function(){return v(t)}},void 0,function(){return{state:"fulfilled",value:t}})}function q(t,n,e){return x(t).spread(n,e)}function H(t,n,e){return x(t).dispatch(n,e)}function L(t){return C(t,function(t){var n=0,e=R();return s(t,function(r,o,i){var u;_(o)&&"fulfilled"===(u=o.inspect()).state?t[i]=u.value:(++n,C(o,function(r){t[i]=r,0==--n&&e.resolve(t)},e.reject,function(t){e.notify({index:i,value:t})}))},void 0),0===n&&e.resolve(t),e.promise})}function z(t){if(0===t.length)return x.resolve();var n=x.defer(),e=0;return s(t,function(r,o,i){var u=t[i];e++,C(u,function(t){n.resolve(t)},function(t){if(0==--e){var r=t||new Error(""+t);r.message="Q can't get fulfillment value from any promise, all promises were rejected. Last error message: "+r.message,n.reject(r)}},function(t){n.notify({index:i,value:t})})},void 0),n.promise}function G(t){return C(t,function(t){return t=l(t,x),C(L(l(t,function(t){return C(t,o,o)})),function(){return t})})}x.resetUnhandledRejections=$,x.getUnhandledReasons=function(){return I.slice()},x.stopUnhandledRejectionTracking=function(){$(),U=!1},$(),x.reject=B,x.fulfill=V,x.master=function(t){return O({isDef:function(){}},function(n,e){return H(t,n,e)},function(){return x(t).inspect()})},x.spread=q,O.prototype.spread=function(t,n){return this.all().then(function(n){return t.apply(void 0,n)},n)},x.async=function(t){return function(){function n(t,n){var i;if("undefined"==typeof StopIteration){try{i=e[t](n)}catch(u){return B(u)}return i.done?x(i.value):C(i.value,r,o)}try{i=e[t](n)}catch(u){return function(t){return"[object StopIteration]"===m(t)||t instanceof f}(u)?x(u.value):B(u)}return C(i,r,o)}var e=t.apply(this,arguments),r=n.bind(n,"next"),o=n.bind(n,"throw");return r()}},x.spawn=function(t){x.done(x.async(t)())},x.return=function(t){throw new f(t)},x.promised=function(t){return function(){return q([this,L(arguments)],function(n,e){return t.apply(n,e)})}},x.dispatch=H,O.prototype.dispatch=function(t,n){var e=this,r=R();return x.nextTick(function(){e.promiseDispatch(r.resolve,t,n)}),r.promise},x.get=function(t,n){return x(t).dispatch("get",[n])},O.prototype.get=function(t){return this.dispatch("get",[t])},x.set=function(t,n,e){return x(t).dispatch("set",[n,e])},O.prototype.set=function(t,n){return this.dispatch("set",[t,n])},x.del=x.delete=function(t,n){return x(t).dispatch("delete",[n])},O.prototype.del=O.prototype.delete=function(t){return this.dispatch("delete",[t])},x.mapply=x.post=function(t,n,e){return x(t).dispatch("post",[n,e])},O.prototype.mapply=O.prototype.post=function(t,n){return this.dispatch("post",[t,n])},x.send=x.mcall=x.invoke=function(t,n){return x(t).dispatch("post",[n,p(arguments,2)])},O.prototype.send=O.prototype.mcall=O.prototype.invoke=function(t){return this.dispatch("post",[t,p(arguments,1)])},x.fapply=function(t,n){return x(t).dispatch("apply",[void 0,n])},O.prototype.fapply=function(t){return this.dispatch("apply",[void 0,t])},x.try=x.fcall=function(t){return x(t).dispatch("apply",[void 0,p(arguments,1)])},O.prototype.fcall=function(){return this.dispatch("apply",[void 0,p(arguments)])},x.fbind=function(t){var n=x(t),e=p(arguments,1);return function(){return n.dispatch("apply",[this,e.concat(p(arguments))])}},O.prototype.fbind=function(){var t=this,n=p(arguments);return function(){return t.dispatch("apply",[this,n.concat(p(arguments))])}},x.keys=function(t){return x(t).dispatch("keys",[])},O.prototype.keys=function(){return this.dispatch("keys",[])},x.all=L,O.prototype.all=function(){return L(this)},x.any=z,O.prototype.any=function(){return z(this)},x.allResolved=(P=G,D="allResolved",A="allSettled",function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(D+" is deprecated, use "+A+" instead.",new Error("").stack),P.apply(P,arguments)}),O.prototype.allResolved=function(){return G(this)},x.allSettled=function(t){return x(t).allSettled()},O.prototype.allSettled=function(){return this.then(function(t){return L(l(t,function(t){function n(){return t.inspect()}return(t=x(t)).then(n,n)}))})},x.fail=x.catch=function(t,n){return x(t).then(void 0,n)},O.prototype.fail=O.prototype.catch=function(t){return this.then(void 0,t)},x.progress=function(t,n){return x(t).then(void 0,void 0,n)},O.prototype.progress=function(t){return this.then(void 0,void 0,t)},x.fin=x.finally=function(t,n){return x(t).finally(n)},O.prototype.fin=O.prototype.finally=function(t){if(!t||"function"!=typeof t.apply)throw new Error("Q can't apply finally callback");return t=x(t),this.then(function(n){return t.fcall().then(function(){return n})},function(n){return t.fcall().then(function(){throw n})})},x.done=function(t,n,e,r){return x(t).done(n,e,r)},O.prototype.done=function(t,n,r){var o=function(t){x.nextTick(function(){if(w(t,i),!x.onerror)throw t;x.onerror(t)})},i=t||n||r?this.then(t,n,r):this;"object"==typeof e&&e&&e.domain&&(o=e.domain.bind(o)),i.then(void 0,o)},x.timeout=function(t,n,e){return x(t).timeout(n,e)},O.prototype.timeout=function(t,n){var e=R(),r=setTimeout(function(){n&&"string"!=typeof n||((n=new Error(n||"Timed out after "+t+" ms")).code="ETIMEDOUT"),e.reject(n)},t);return this.then(function(t){clearTimeout(r),e.resolve(t)},function(t){clearTimeout(r),e.reject(t)},e.notify),e.promise},x.delay=function(t,n){return void 0===n&&(n=t,t=void 0),x(t).delay(n)},O.prototype.delay=function(t){return this.then(function(n){var e=R();return setTimeout(function(){e.resolve(n)},t),e.promise})},x.nfapply=function(t,n){return x(t).nfapply(n)},O.prototype.nfapply=function(t){var n=R(),e=p(t);return e.push(n.makeNodeResolver()),this.fapply(e).fail(n.reject),n.promise},x.nfcall=function(t){var n=p(arguments,1);return x(t).nfapply(n)},O.prototype.nfcall=function(){var t=p(arguments),n=R();return t.push(n.makeNodeResolver()),this.fapply(t).fail(n.reject),n.promise},x.nfbind=x.denodeify=function(t){if(void 0===t)throw new Error("Q can't wrap an undefined function");var n=p(arguments,1);return function(){var e=n.concat(p(arguments)),r=R();return e.push(r.makeNodeResolver()),x(t).fapply(e).fail(r.reject),r.promise}},O.prototype.nfbind=O.prototype.denodeify=function(){var t=p(arguments);return t.unshift(this),x.denodeify.apply(void 0,t)},x.nbind=function(t,n){var e=p(arguments,2);return function(){var r=e.concat(p(arguments)),o=R();return r.push(o.makeNodeResolver()),x(function(){return t.apply(n,arguments)}).fapply(r).fail(o.reject),o.promise}},O.prototype.nbind=function(){var t=p(arguments,0);return t.unshift(this),x.nbind.apply(void 0,t)},x.nmapply=x.npost=function(t,n,e){return x(t).npost(n,e)},O.prototype.nmapply=O.prototype.npost=function(t,n){var e=p(n||[]),r=R();return e.push(r.makeNodeResolver()),this.dispatch("post",[t,e]).fail(r.reject),r.promise},x.nsend=x.nmcall=x.ninvoke=function(t,n){var e=p(arguments,2),r=R();return e.push(r.makeNodeResolver()),x(t).dispatch("post",[n,e]).fail(r.reject),r.promise},O.prototype.nsend=O.prototype.nmcall=O.prototype.ninvoke=function(t){var n=p(arguments,1),e=R();return n.push(e.makeNodeResolver()),this.dispatch("post",[t,n]).fail(e.reject),e.promise},x.nodeify=function(t,n){return x(t).nodeify(n)},O.prototype.nodeify=function(t){if(!t)return this;this.then(function(n){x.nextTick(function(){t(null,n)})},function(n){x.nextTick(function(){t(n)})})},x.noConflict=function(){throw new Error("Q.noConflict only works when Q is used as a global")};var J=b();return x});
},{"process":"pBGv"}],"FOZT":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.$=l,exports.$$=a,exports.ImageDownloadLogHelper=void 0,exports.convertToNodeByStr=f,exports.convertToNodeFirstElementByStr=m,exports.getBorderHeight=x,exports.getChromeVer=s,exports.getElementFrame=w,exports.getQuoteClassPostfix=O,exports.hideDomElement=v,exports.isAndroid=i,exports.isIOS=n,exports.isNull=y,exports.isNullOrNaN=h,exports.isPad=D,exports.pointInsideRect=S,exports.setContentScrollable=p,exports.showDomElement=g,exports.stopWindowScroll=d,exports.windowScrollTo=c;var t=require("./commands"),e={iOS:1,Android:2,unsupported:99};function r(){var t=navigator.userAgent;return t.indexOf("Android")>-1||t.indexOf("Adr")>-1?e.Android:t.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)||t.indexOf("Mac OS X")>-1||t.indexOf("AppleWebKit")>-1?e.iOS:e.unsupported}var o=r();function n(){return o==e.iOS}function i(){return o==e.Android}function s(){if(i()){var t=navigator.userAgent.match(/Chrom(e|ium)\/([0-9]+)\./);return!!t&&parseInt(t[2],10)}return!1}function l(t){return document.querySelector(t)}function a(t){return document.querySelectorAll(t)}var u=null;function c(t,e){t=parseInt(t);var r=l("html"),o=r.getBoundingClientRect().height;if(t>=r.scrollHeight-o){var n=Math.ceil(t+o);document.body.style.height="".concat(n,"px")}else if(t<0)return;var i=window.pageYOffset<t;clearInterval(u),u=setInterval(function(){var r=parseInt(Math.min(Math.abs(window.pageYOffset-t),6)),o=parseInt(window.pageYOffset);r>0&&i&&o<t?window.scrollBy(0,r):r>0&&!i&&o>t?window.scrollBy(0,-r):(clearInterval(u),e&&e())},.5)}function d(){clearInterval(u)}function p(t){var e=l("html");if(t){if(e.style.top){var r=parseFloat(e.style.top);e.style.position=null,e.style.top=null,e.style.width=null,document.body.style.height=null,window.scrollTo(0,-r)}}else e.style.top="".concat(e.getBoundingClientRect().top,"px"),e.style.width="100%",e.style.position="fixed"}function f(t){var e=document.createElement("div");return e.innerHTML=t,e}function m(t){return f(t).firstElementChild}function y(t){try{return t.toString(),!1}catch(e){return!0}}function h(t){return y(t)||isNaN(t)}function v(t){if(!y(t)&&!t.classList.contains("display-none")){var e=t.style.display;y(e)||"none"==e||t.setAttribute("lark-pre-display",e),t.style.setProperty("display","none","important")}}function g(t){if(!y(t)){var e=t.getAttribute("lark-pre-display")||"";for(t.style.setProperty("display",e),t.removeAttribute("lark-pre-display");t.classList.contains("display-none");)t.classList.remove("display-none")}}function x(t){var e=getComputedStyle(t);return parseFloat(e.getPropertyValue("border-top-width")||"0px")+parseFloat(e.getPropertyValue("border-bottom-width")||"0px")}function w(t){if(t&&t.getBoundingClientRect){var e=t.getBoundingClientRect();return{x:e.x,y:e.y,width:e.width,height:e.height}}}function D(){return"true"===window.isPad}function S(e,r,o){var n,i,s,l,a;if(null==e.x||null==e.y||null==e.width||null==e.height||null==r.x||null==r.y)return t.Commands.log("pointInsideRect not valid params"),!1;var u=null!==(i=(o=null!==(n=o)&&void 0!==n?n:{top:0,right:0,bottom:0,left:0}).top)&&void 0!==i?i:0,c=null!==(s=o.right)&&void 0!==s?s:0,d=null!==(l=o.bottom)&&void 0!==l?l:0,p=null!==(a=o.left)&&void 0!==a?a:0,f=r.x>=e.x+p&&r.x<=e.x+e.width-c,m=r.y>=e.y+u&&r.y<=e.y+e.height-d;return f&&m}function O(t){if(t.matches("[larkmailquote=true]"))return t.className.replace(/[^0-9]/gi,"");if(t){var e=t.querySelector("[larkmailquote=true]");if(e)return e.className.replace(/[^0-9]/gi,"")}}var T=function(){var e=0,r=1,o=2;function n(){this.startTimeDict={}}function i(e,r,o){var n=e[r];if(n){var i=n.start;if(i){var s=Date.now()-i,l=n.isRetry;t.Commands.track("template_image_download_time_dev",{cost_time:s,result_code:o,is_retry:l})}}}return n.prototype.startRetry=function(t){this.startTimeDict[t]={start:Date.now(),isRetry:1}},n.prototype.startDownload=function(t){this.startTimeDict[t]={start:Date.now(),isRetry:0}},n.prototype.onTimeout=function(t){i(this.startTimeDict,t,o),this.startTimeDict[t]=void 0},n.prototype.onError=function(t){i(this.startTimeDict,t,e),this.startTimeDict[t]=void 0},n.prototype.onLoad=function(t){i(this.startTimeDict,t,r),this.startTimeDict[t]=void 0},n}();exports.ImageDownloadLogHelper=T;
},{"./commands":"TnH5"}],"TnH5":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.LogLevel=exports.Commands=void 0;var e=require("q"),o=require("./utils");function t(e,o,t){return o in e?Object.defineProperty(e,o,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[o]=t,e}function a(){}var n={debug:0,info:1,warn:2,error:3};function r(e){if((0,o.isIOS)())"log"!=e.method&&i.log("invokeMethod ios:"+e.method,n.info),window.webkit.messageHandlers.invoke.postMessage(e);else if((0,o.isAndroid)()){"log"!=e.method&&i.log("invokeMethod android:"+e.method,n.info);var t=JSON.stringify(e);window.messagelist.prompt(t)}}function s(){for(var e=document.querySelectorAll(".menu"),o=0;o<e.length;o++){e[o].classList.remove("open-menu")}}exports.LogLevel=n,a.prototype.call=function(e){},a.prototype.imageStartLoad=function(e,o){r({method:"imageStartLoad",args:{src:e,timestamp:o}})},a.prototype.imageOnLoad=function(e,o){r({method:"imageOnLoad",args:{src:e,timestamp:o}})},a.prototype.imageLoadingOnScreen=function(e){r({method:"imageLoadingOnScreen",args:{src:e}})},a.prototype.popoverDidClose=function(){r({method:"popoverDidClose",args:{}})},a.prototype.fixScaleFinish=function(){r({method:"fixScaleFinish",args:{}})},a.prototype.smartReply=function(e,o){r({method:"smartReply",args:{content:e,index:o}})},a.prototype.readmoreMessage=function(e){s(),i.log("readmoreMessage",n.info),r({method:"readmore",args:{messageId:e}})},a.prototype.recallDetail=function(e){i.log("recallDetail command",n.info),r({method:"recallDetail",args:{messageId:e}})},a.prototype.openAttachment=function(e,o){s(),i.log("openAttachment",n.info),r({method:"openAttachment",args:{file_token:e,file_url:o}})},a.prototype.deleteDraft=function(e,o){s(),i.log("deleteDraft",n.info),r({method:"deleteDraft",args:{draftId:e,threadID:o}})},a.prototype.scrollTo=function(e){i.log("scrollTo",n.info),r({method:"scrollTo",args:{offsetY:e}})},a.prototype.clickDraft=function(e,o){s(),i.log("clickDraft",n.info),r({method:"clickDraft",args:{draftId:e,replyMessageId:o}})},a.prototype.clickLabel=function(e){s(),i.log("clickLabel",n.info),r({method:"clickLabel",args:{label:e}})},a.prototype.clickImage=function(e,o){s(),i.log("clickImage",n.info),r({method:"clickImage",args:{currentImage:e,images:o}})},a.prototype.needContents=function(e,o){i.log("needContents",n.info),r({method:"needContents",args:{msgIDs:e,type:o}})},a.prototype.needContentLocateSearch=function(e,o){i.log("needContentLocateSearch",n.info),r({method:"needContentLocateSearch",args:{messageID:e,idx:o}})},a.prototype.exitSearch=function(){i.log("exitSearch",n.info,!0);r({method:"exitSearch",args:{}})},a.prototype.searchResults=function(e,o,t,a){i.log("searchResults",n.info,!0);var s={method:"searchResults",args:{key:e,searchType:o,resultInfo:t,idx:a}};i.log("testSearchABC searchResults ".concat(JSON.stringify(s))),r(s)},a.prototype.checkUrls=function(e){i.log("checkUrls",n.info),r({method:"checkUrls",args:{urls:e}})},a.prototype.checkUserids=function(e){i.log("checkUserids",n.info),r({method:"checkUserids",args:{userids:e}})},a.prototype.showCalendarDetail=function(e){console.log("showCalendarDetail ",e),r({method:"showCalendarDetail",args:{messageId:e}})},a.prototype.acceptCalendar=function(e){s(),console.log("acceptCalendar ",e),r({method:"acceptCalendar",args:{messageId:e}})},a.prototype.refuseCalendar=function(e){s(),console.log("refuseCalendar ",e),r({method:"refuseCalendar",args:{messageId:e}})},a.prototype.pendingCalendar=function(e){s(),console.log("pendingCalendar ",e),r({method:"pendingCalendar",args:{messageId:e}})},a.prototype.clickFlag=function(){s(),console.log("clickFlag ");r({method:"clickFlag",args:{}})},a.prototype.log=function(e,o,t){void 0===o&&(o=n.info);var a={method:"log",args:{content:e,level:o}};(!0===o||t)&&console.log(e),r(a)},a.prototype.receiverClick=function(e,o){r({method:"receiverClick",args:{messageid:e,expand:o}})},a.prototype.messageclick=function(e,o,t){s(),r({method:"messageClick",args:{messageid:e,expand:o,needContent:t}})},a.prototype.sendStatusClick=function(e){r({method:"sendStatusClick",args:{messageId:e}})},a.prototype.addressclick=function(e,o,t,a,n,i){s(),r({method:"addressClick",args:{address:e,userid:o,addressFrame:t,name:a,userType:n,tenantId:i}})},a.prototype.avatarimageclick=function(e,o,t,a,n){s(),r({method:"avatarClick",args:{address:o,userid:e,name:t,userType:a,tenantId:n}})},a.prototype.domReady=function(e){r({method:"domReady",args:{}})},a.prototype.track=function(e,o){r({method:"track",args:{event:e,params:o}})},a.prototype.translate=function(e){s(),i.log("translateClick",n.info),r({method:"translateClick",args:{messageID:e}})},a.prototype.selectTranslationLanguageClick=function(e){r({method:"selectTranslationLanguageClick",args:{messageID:e}})},a.prototype.viewOriginalClick=function(e){r({method:"viewOriginalClick",args:{messageID:e}})},a.prototype.viewTranslationClick=function(e){r({method:"viewTranslationClick",args:{messageID:e}})},a.prototype.cancelScheduleSendClick=function(e){r({method:"cancelScheduleSendClick",args:{messageID:e}})},a.prototype.expandMessagesFirstVisible=function(e){r({method:"expandMessagesFirstVisible",args:{messageIds:e}})},a.prototype.translationBlockClick=function(e,o,t){r({method:"translationBlockClick",args:{messageId:e,htmlBody:o,bottomOffset:t}})},a.prototype.shareManageButtonClick=function(){r({method:"shareManageButtonClick",args:{}})},a.prototype.shareCheckButtonClick=function(){r({method:"shareCheckButtonClick",args:{}})},a.prototype.shareManageButtonPosition=function(e,o,t,a){r({method:"shareManageButtonPosition",args:{top:e,left:o,width:t,height:a}})},a.prototype.contextMenuClick=function(e,o,a,n,s){var i;r({method:"contextMenuClick",args:(i={threadId:e},t(i,"threadId",e),t(i,"messageId",o),t(i,"isTranslated",a),t(i,"avatar",n),t(i,"menuFrame",s),i)})},a.prototype.reportMessage=function(e){i.log("reportMessage ".concat(e),n.info,!0),r({method:"reportMessage",args:{messageID:e}})},a.prototype.trustMessage=function(e){i.log("trustMessage ".concat(e),n.info,!0),r({method:"trustMessage",args:{messageID:e}})},a.prototype.closeSafetyBanner=function(e){i.log("closeSafetyBanner ".concat(e),n.info,!0),r({method:"closeSafetyBanner",args:{messageID:e}})};var i=new a;exports.Commands=i,i.log("js commands finish",n.info);
},{"q":"vFlK","./utils":"FOZT"}],"IjMb":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAvatarUserids=o,exports.initAvatar=s,exports.updateAvatar=n;var e=require("./commands"),t=["#133c9a","#3370ff","#ff8800","#f76964","#7f3bf5","#4954e6","#b3d600"];function r(e){var r=e.split("").reduce(function(e,t){return e+t.charCodeAt(0)},0)%t.length;return t[r]||"#EFF0F1"}var a=[];function n(e,t){for(var n=e.querySelectorAll(".avatar"),s=0;s<n.length;s++){var o=n[s],u=o.getAttribute("user-name"),l=o.getAttribute("user-id");if(void 0===l||null==l||"0"==l||l.length<1||!0===t)if(u&&u.length>0){var i=r(u);o.style.background=i,o.innerHTML=u.substr(0,1).toUpperCase()}else o.classList.add("avatar-placeholder");else o.classList.add("avatar-placeholder"),a.push(l)}}function s(){try{n(document)}catch(t){e.Commands.log("updateAvatar error:"+t,e.LogLevel.info)}}function o(){return a}
},{"./commands":"TnH5"}],"I9d7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.markQuoteRendered=exports.handleBlock=exports.renderQuote=exports.dotQuoteStyle=exports.quoteStyle=void 0;var e=require("../utils"),n="url(data:image/svg+xml;base64,PHN2ZyBmaWxsPSJub25lIiBoZWlnaHQ9IjI0IiB2aWV3Qm94PSIwIDAgMjQgMjQiIHdpZHRoPSIyNCIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cGF0aCBkPSJtMTEuNDIzOSAxOC43MDI1LTguNzQ1MDMtMTAuOTAyNTJjLS4yMzg0OS0uMjk3LS4yMzg0OS0uNzc4OTkgMC0xLjA3NjQ4LjExNDUtLjE0MzAyLjI3LS4yMjMwMS40MzE0OS0uMjIzMDFoMTcuNzc5NTRjLjMzNyAwIC42MTA1LjM0MDk5LjYxMDUuNzYxNDggMCAuMjAyMDEtLjA2NDUuMzk1MDItLjE3OS41MzgwMWwtOC43NDUgMTAuOTAzMDJjLS4zMTguMzk2NS0uODM0LjM5NjUtMS4xNTIgMHoiIGZpbGw9IiM4Rjk1OUUiLz48L3N2Zz4=)",M="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHBhdGggZD0iTTExLjQyMzkgNS4yOTc0TDIuNjc4ODcgMTYuMTk5OUMyLjQ0MDM4IDE2LjQ5NjkgMi40NDAzOCAxNi45Nzg5IDIuNjc4ODcgMTcuMjc2NEMyLjc5MzM3IDE3LjQxOTQgMi45NDg4OCAxNy40OTk0IDMuMTEwMzYgMTcuNDk5NEgyMC44ODk5QzIxLjIyNjkgMTcuNDk5NCAyMS41MDA0IDE3LjE1ODQgMjEuNTAwNCAxNi43Mzc5QzIxLjUwMDQgMTYuNTM1OSAyMS40MzU5IDE2LjM0MjkgMjEuMzIxNCAxNi4xOTk5TDEyLjU3NjQgNS4yOTY4OEMxMi4yNTg0IDQuOTAwMzkgMTEuNzQyNCA0LjkwMDM5IDExLjQyNDQgNS4yOTY4OEwxMS40MjM5IDUuMjk3NFoiIGZpbGw9IiM4Rjk1OUUiLz4KPC9zdmc+Cg==)",i="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB5PSI2IiB3aWR0aD0iMjQiIGhlaWdodD0iMTIiIHJ4PSI0IiBmaWxsPSIjRUZGMEYxIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00LjUgMTJDNC41IDExLjE3MTYgNS4xNzE1NyAxMC41IDYgMTAuNUM2LjgyODQzIDEwLjUgNy41IDExLjE3MTYgNy41IDEyQzcuNSAxMi44Mjg0IDYuODI4NDMgMTMuNSA2IDEzLjVDNS4xNzE1NyAxMy41IDQuNSAxMi44Mjg0IDQuNSAxMlpNMTAuNSAxMkMxMC41IDExLjE3MTYgMTEuMTcxNiAxMC41IDEyIDEwLjVDMTIuODI4NCAxMC41IDEzLjUgMTEuMTcxNiAxMy41IDEyQzEzLjUgMTIuODI4NCAxMi44Mjg0IDEzLjUgMTIgMTMuNUMxMS4xNzE2IDEzLjUgMTAuNSAxMi44Mjg0IDEwLjUgMTJaTTE4IDEwLjVDMTcuMTcxNiAxMC41IDE2LjUgMTEuMTcxNiAxNi41IDEyQzE2LjUgMTIuODI4NCAxNy4xNzE2IDEzLjUgMTggMTMuNUMxOC44Mjg0IDEzLjUgMTkuNSAxMi44Mjg0IDE5LjUgMTJDMTkuNSAxMS4xNzE2IDE4LjgyODQgMTAuNSAxOCAxMC41WiIgZmlsbD0iIzJCMkYzNiIvPjwvc3ZnPg==)",t="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB5PSI2IiB3aWR0aD0iMjQiIGhlaWdodD0iMTIiIHJ4PSI0IiBmaWxsPSIjRUZGMEYxIi8+PHBhdGggZmlsbC1ydWxlPSJldmVub2RkIiBjbGlwLXJ1bGU9ImV2ZW5vZGQiIGQ9Ik00LjUgMTJDNC41IDExLjE3MTYgNS4xNzE1NyAxMC41IDYgMTAuNUM2LjgyODQzIDEwLjUgNy41IDExLjE3MTYgNy41IDEyQzcuNSAxMi44Mjg0IDYuODI4NDMgMTMuNSA2IDEzLjVDNS4xNzE1NyAxMy41IDQuNSAxMi44Mjg0IDQuNSAxMlpNMTAuNSAxMkMxMC41IDExLjE3MTYgMTEuMTcxNiAxMC41IDEyIDEwLjVDMTIuODI4NCAxMC41IDEzLjUgMTEuMTcxNiAxMy41IDEyQzEzLjUgMTIuODI4NCAxMi44Mjg0IDEzLjUgMTIgMTMuNUMxMS4xNzE2IDEzLjUgMTAuNSAxMi44Mjg0IDEwLjUgMTJaTTE4IDEwLjVDMTcuMTcxNiAxMC41IDE2LjUgMTEuMTcxNiAxNi41IDEyQzE2LjUgMTIuODI4NCAxNy4xNzE2IDEzLjUgMTggMTMuNUMxOC44Mjg0IDEzLjUgMTkuNSAxMi44Mjg0IDE5LjUgMTJDMTkuNSAxMS4xNzE2IDE4LjgyODQgMTAuNSAxOCAxMC41WiIgZmlsbD0iI0JCQkZDNCIvPjwvc3ZnPg==)",o="url(data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMjQiIGhlaWdodD0iMjQiIHZpZXdCb3g9IjAgMCAyNCAyNCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj48cmVjdCB5PSI2IiB3aWR0aD0iMjQiIGhlaWdodD0iMTIiIHJ4PSI0IiBmaWxsPSIjMUYyMzI5IiBmaWxsLW9wYWNpdHk9IjAuMTUiLz48cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTQuNSAxMkM0LjUgMTEuMTcxNiA1LjE3MTU3IDEwLjUgNiAxMC41QzYuODI4NDMgMTAuNSA3LjUgMTEuMTcxNiA3LjUgMTJDNy41IDEyLjgyODQgNi44Mjg0MyAxMy41IDYgMTMuNUM1LjE3MTU3IDEzLjUgNC41IDEyLjgyODQgNC41IDEyWk0xMC41IDEyQzEwLjUgMTEuMTcxNiAxMS4xNzE2IDEwLjUgMTIgMTAuNUMxMi44Mjg0IDEwLjUgMTMuNSAxMS4xNzE2IDEzLjUgMTJDMTMuNSAxMi44Mjg0IDEyLjgyODQgMTMuNSAxMiAxMy41QzExLjE3MTYgMTMuNSAxMC41IDEyLjgyODQgMTAuNSAxMlpNMTggMTAuNUMxNy4xNzE2IDEwLjUgMTYuNSAxMS4xNzE2IDE2LjUgMTJDMTYuNSAxMi44Mjg0IDE3LjE3MTYgMTMuNSAxOCAxMy41QzE4LjgyODQgMTMuNSAxOS41IDEyLjgyODQgMTkuNSAxMkMxOS41IDExLjE3MTYgMTguODI4NCAxMC41IDE4IDEwLjVaIiBmaWxsPSIjMkIyRjM2Ii8+PC9zdmc+)",u="lark-mail-quote",g=[{selector:'div>div[dir="ltr"]+blockquote',value:function(e){return e.parentElement}},{selector:'blockquote>div[dir="ltr"]',value:function(e){return e}},{selector:'[id*="'+u+'"]',value:function(e){return e}}],I=Date.now(),a="collapse"+I,l="quote"+I,d="controller"+I,x=500;exports.quoteStyle="\n.adit-html-block__attr {\n  font-size: 14px;\n  line-height: 22px;\n}\n.control-point-wrapper {\n  min-height: 48px;\n}\n."+d+" .quote-control-icon {\n  background-image: "+M+";\n  background-repeat: no-repeat;\n  background-size: contain;\n  width: 12px;\n  height: 12px;\n}\n."+d+" .quote-control-text {\n  margin-left: 4px;\n  font-size: 14px;\n  line-height: 20px;\n  color: #646A73;\n  user-select: none;\n}\n."+a+" ."+l+" {\n  display: none!important;\n}\n."+d+" {\n  position: absolute;\n  border-radius: 4px;\n  margin-left: -4px;\n  padding: 2px 4px;\n  align-items: center;\n  display: flex;\n  user-select: none;\n  outline-style: none;\n  -webkit-touch-callout: none;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n  margin-top: 24px;\n}\n."+d+":active {\n  background: rgba(31, 35, 41, 0.08);\n}\n."+a+" ."+d+" .quote-control-icon {\n  background-image: "+n+";\n}\n",exports.dotQuoteStyle="\n."+d+" .quote-control-icon {\n  background-image: "+t+";\n  background-repeat: no-repeat;\n  background-size: contain;\n  width: 24px;\n  height: 24px;\n}\n."+d+" .quote-control-text {\n  margin-left: 4px;\n  line-height: 20px;\n  color: #646A73;\n  user-select: none;\n}\n."+a+" ."+l+" {\n  display: none!important;\n}\n."+d+" {\n  border-radius: 4px;\n  padding: 2px 4px;\n  align-items: center;\n  display: flex;\n  user-select: none;\n  outline-style: none;\n  -webkit-touch-callout: none;\n  -webkit-tap-highlight-color: rgba(0,0,0,0);\n  margin-top: 24px;\n}\n."+d+":active .quote-control-icon {\n  background-image: "+o+";\n}\n."+a+" ."+d+":active .quote-control-icon {\n  background-image: "+o+";\n}\n."+a+" ."+d+" .quote-control-icon {\n  background-image: "+i+";\n}\n";var r=document.createElement("style"),c=window.quoteHideTitle&&window.quoteExpandTitle&&window.quoteHideTitle.length>0&&window.quoteExpandTitle.length>0;function D(e){var n=document.createElement("div");n.innerHTML="<div>"+e+"</div>",1===n.children.length&&(n=n.children[0]);var M=s(n);if(M){var i=M.num,t=M.quote;if(t)if(c&&(t.style.marginTop="16px"),i>1){var o=t.querySelector("#quote-divider-line");o&&o.style&&(o.style.display="none"),j(n,t)}else if(1===i){E(e).height>x&&j(n,t)}}return n}function N(){if(c){var n='\n    <div class="control-point-wrapper">\n      <div class="'+d+'" larkmailquote="true">\n       <div class="quote-control-icon"></div>\n       <div class="quote-control-text hide-quote">'+window.quoteHideTitle+'</div>\n       <div class="quote-control-text expand-quote">'+window.quoteExpandTitle+"</div>\n      </div>\n    </div>\n    ";return e.convertToNodeByStr(n)}n='\n    <div class="control-point-wrapper">\n      <div class="'+d+' dotQuoteStyle" larkmailquote="true">\n       <div class="quote-control-icon"></div>\n       <div class="quote-control-text hide-quote"></div>\n       <div class="quote-control-text expand-quote"></div>\n      </div>\n    </div>\n    ';return e.convertToNodeByStr(n)}function j(e,n){if(n.parentElement){n.classList.add(l);var M=document.createElement("div"),i=N();M.appendChild(i),M.appendChild(n.cloneNode(!0)),n.parentElement.replaceChild(M,n),e.classList.add(a),e.classList.add("quoteControlRoot")}}function T(e){if(!e.classList.contains("quoteRendered")){var n=g.map(function(e){return e.selector});n.push(".gmail_quote"),n.forEach(function(n){e.querySelectorAll(n).forEach(function(e){e.classList.add("quoteRendered")})})}}function E(e){var n=document.createElement("div");n.style.cssText="height: 0; overflow: hidden; position: absolute";var M=document.createElement("div");M.innerHTML=e,T(M),n.appendChild(M),document.body.appendChild(n);var i=M.getBoundingClientRect();return n.remove(),{width:i.width,height:i.height}}function s(e){for(var n,M=0,i=0;i<g.length;i++){var t=g[i].selector,o=e.querySelectorAll(t);o.length>0&&(M+=o.length,n&&!g[i].value(o[0]).contains(n)||(n=g[i].value(o[0])))}return{num:M,quote:n}}r.innerHTML=c?exports.quoteStyle:exports.dotQuoteStyle,document.head.appendChild(r),exports.renderQuote=D,exports.handleBlock=j,exports.markQuoteRendered=T;
},{"../utils":"FOZT"}],"dnLp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.formatContent=o,exports.renderContentAndQuoteForMessage=i;var e=require("./renderQuote"),r=require("../commands");function o(e){try{var o=e.innerHTML;if(0==o.indexOf("\x3c!--")&&"--\x3e"==o.slice(-3)){var t=n(o=o.slice(4,-3));e.innerHTML="",e.appendChild(t)}}catch(s){r.Commands.log("formatContent error:"+s,r.LogLevel.error)}}function n(e){var r=document.createElement("div");return"string"==typeof e&&(r.innerHTML=e),r}function t(o){if(o){var n=o.closest(".message-item");if(n){r.Commands.log("renderMessageListQuoteForMessage",r.LogLevel.info);var t=(0,e.renderQuote)(o.innerHTML);return o.innerHTML="",o.appendChild(t),n}}}function s(e,r){var o=r.querySelector(".is_body_clipped"),n=e.querySelector("[larkmailquote=true]");if(o)if(n){var t=n.closest(".quoteControlRoot");if(t){var s="collapse"+n.className.replace(/[^0-9]/gi,"");o&&(t.classList.contains(s)?o.style.display="none":o.style.display="flex")}}else o.style.display="flex"}function i(n,i){try{if(n){var a=n.closest(".message-item");a&&(o(n),i&&t(n),s(n,a),(0,e.markQuoteRendered)(a),r.Commands.log("renderContentAndQuote ",r.LogLevel.info))}}catch(l){r.Commands.log("renderContentAndQuoteForMessage error:"+l,r.LogLevel.error)}}r.Commands.log("renderQuote",r.LogLevel.info);
},{"./renderQuote":"I9d7","../commands":"TnH5"}],"BRBp":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Popover=void 0;var e=require("./utils"),t=require("./commands"),o=function(){function o(e){this.popoverNodeStr='<div class="translate-popover"><div class="drag-view"><div class="drag-view-body auto-scroll"><div class="drag-view-title">'.concat(e,'</div><div class="popover-editor"><div class="innerbody"></div></div></div></div></div>')}function i(t,o,i){var l=(0,e.$)(".translate-popover");l||(l=(0,e.convertToNodeFirstElementByStr)(o),document.body.appendChild(l),function(e){e.querySelector(".drag-view").addEventListener("click",function(e){var t=e.target.classList.contains("drag-view");if(t)for(var o=document.elementsFromPoint(e.clientX,e.clientY),i=0;i<o.length;i++){var l=o[i],c=l.closest(".selected-translation");if(c){for(var r=c.querySelectorAll("a"),s=0;s<r.length;s++){var d=r[s],a=d.getBoundingClientRect();if(e.clientX>=a.left&&e.clientX<=a.right&&e.clientY>=a.top&&e.clientY<=a.bottom){d.click(),t=!1;break}}if(!t)break}}t&&n()});var t=e.querySelector(".drag-view-title"),o=e.querySelector(".drag-view-body");t.addEventListener("touchstart",function(e){var i=e.touches[0].clientY||e.changedTouches[0].clientY,l=o.getBoundingClientRect().height;t.addEventListener("touchmove",function(e){o.classList.remove("auto-scroll");var t=e.touches[0]||e.changedTouches[0],n=t.clientY,c=l+(i-n);o.style.height="".concat(c,"px")}),t.addEventListener("touchend",function(e){var t=e.touches[0]||e.changedTouches[0],i=t.clientY;o.classList.add("auto-scroll");var l=window.innerHeight,c=i/l*100;c<=50?o.style.height="".concat(.8*document.documentElement.clientHeight,"px"):c<=70?o.style.height="".concat(.4*document.documentElement.clientHeight,"px"):c>70&&n()})})}(l));var c=l.querySelector(".drag-view");if("visible"!=c.style.visibility){var r=l.querySelector(".drag-view-body");c.style.visibility="visible",r.style.height="".concat(i,"px");for(var s=l.querySelector(".innerbody");s.lastChild;)s.removeChild(s.lastChild);return s.appendChild(t),l}}function n(){var o=(0,e.$)(".drag-view"),i=o.querySelector(".drag-view-body");i.addEventListener("transitionend",function e(){o.style.visibility="hidden",i.removeEventListener("transitionend",e)}),i.classList.add("auto-scroll"),i.style.height="0px",(0,e.stopWindowScroll)(),(0,e.setContentScrollable)(!0);var n=(0,e.$)(".selected-translation");n&&n.classList.remove("selected-translation"),t.Commands.popoverDidClose()}return o.prototype.close=function(){n()},o.prototype.showWithBody=function(t){i((0,e.convertToNodeFirstElementByStr)('<div style="font-size: 20px;">'.concat(t,"</div>")),this.popoverNodeStr,.4*document.documentElement.clientHeight),(0,e.setContentScrollable)(!1)},o.prototype.show=function(t,o){t.classList.add("selected-translation");var n=o.cloneNode(!0);n.style.display="";var l=.4*document.documentElement.clientHeight;i(n,this.popoverNodeStr,l);var c=(0,e.$)("html"),r=c.getBoundingClientRect(),s=t.getBoundingClientRect().bottom,d=document.documentElement.clientHeight-l;if(s>d){var a=s-d,v=-(r.top-a-10);if(v>=c.scrollHeight-document.documentElement.clientHeight){var u=Math.ceil(v+document.documentElement.clientHeight);document.body.style.height="".concat(u,"px")}(0,e.windowScrollTo)(v,function(){(0,e.setContentScrollable)(!1)})}else(0,e.setContentScrollable)(!1)},o}();exports.Popover=o;
},{"./utils":"FOZT","./commands":"TnH5"}],"zfSF":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.Search=void 0;var t=require("./commands");function e(t,e){return i(t)||s(t,e)||n(t,e)||r()}function r(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function n(t,e){if(t){if("string"==typeof t)return o(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(t,e):void 0}}function o(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function s(t,e){var r=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=r){var n,o,s=[],i=!0,l=!1;try{for(r=r.call(t);!(i=(n=r.next()).done)&&(s.push(n.value),!e||s.length!==e);i=!0);}catch(a){l=!0,o=a}finally{try{i||null==r.return||r.return()}finally{if(l)throw o}}return s}}function i(t){if(Array.isArray(t))return t}var l=function(){var r,n,o="larkmail-mark";function s(e,o,s){try{e=Array.from(e).filter(function(t){return!!t});this.contexts=e,this.matches=0,this.matchNodes=[],this.fakeEllipsisNodeDict={},this.fakeEllipsisOldColor={},r=o,n=s,t.Commands.log("contexts size: "+e.length+" contexts: "+e,t.LogLevel.info)}catch(i){t.Commands.log("Search init error:"+i,!0)}}function i(t){var e="",r=[];return function(t,e){!function t(e,r){if(n&&n(e))return;r(e);var o=e.childNodes;var s=Array.from(o);for(var i=0,l=s.length;i<l;i++)t(s[i],r)}(t,function(t){3==t.nodeType?e(t,!1):0==t.childNodes.length&&t.offsetWidth>0&&e(t,!0)})}(t,function(t,n){r.push({start:e.length,end:(e+=n?"\n":t.textContent).length,node:t})}),{value:e,nodes:r}}function l(t,e,n,s){var i=!0;t.nodes.every(function(l,a){var c=t.nodes[a+1];if(void 0===c||c.start>e){var u=e-l.start,d=(n>l.end?l.end:n)-l.start,h=t.value.substr(0,l.start),f=t.value.substr(d+l.start);if(l.node=function(t,e,n){var s=r?"span":"mark",i=t.splitText(e),l=i.splitText(n-e),a=document.createElement(s);a.setAttribute(o,"true"),r&&a.classList.add(r);return a.textContent=i.textContent,i.parentNode.replaceChild(a,i),l}(l.node,u,d),t.value=h+f,t.nodes.forEach(function(e,r){r>=a&&(t.nodes[r].start>0&&r!==a&&(t.nodes[r].start-=d),t.nodes[r].end-=d)}),n-=d,s(l.node.previousSibling,l.start,i),i=!1,!(n>l.end))return!1;e=l.end}return!0})}return s.prototype.mark=function(t){if(this.matches=0,t&&t.trim().length&&t&&t.length>0&&this.contexts&&this.contexts.length>0)for(var e=0;e<this.contexts.length;e++){var r=i(this.contexts[e]);this.wrapMatches(t,r,this.contexts[e])}},s.prototype.unmark=function(){var t;if(t=r?document.querySelectorAll(".".concat(r)):document.querySelectorAll("[".concat(o,"]")))for(var e=0;e<t.length;e++){var n=t[e];this.unwrapMatches(n)}this.matches=0,this.removeFakeCustomEllipsis()},s.prototype.unwrapMatches=function(t){for(var e=t.parentNode,r=document.createDocumentFragment();t.firstChild;)r.appendChild(t.removeChild(t.firstChild));e.replaceChild(r,t),e.normalize()},s.prototype.wrapMatches=function(t,e,r){var n=this,o=new RegExp(t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),"gim");console.log('ContentSearch with "'+o+'"');for(var s=void 0,i=!1,a=[],c=[];null!==(s=o.exec(e.value));){var u=s.index,d=u+s[0].length,h=this;a=[],l(e,u,d,function(t,e,n){o.lastIndex=e,n&&h.matches++,t&&r&&r.classList.contains("disable-scroll-horizontal")&&t.classList.add("disable-scroll-horizontal"),a.push(t),c.push(t)}),this.matchNodes.push(a),a.length>0&&(i=!0)}if(i&&r&&r.classList.contains("search-need-fake-custom-ellipsis")&&c.length>0){var f=r.closest(".message-item"),p=!0;f&&!f.classList.contains("expand")&&(p=!1,f.classList.add("expand")),c.forEach(function(t){n.addFakeCustomEllipsisIfNeeded(r,t)}),p||f.classList.remove("expand")}},s.prototype.updateFakeEllipsis=function(t){var e=t.closest(".fake-custom-ellipsis");if(t&&e){var r=e.getBoundingClientRect(),n=r.left,o=r.right,s=t.getBoundingClientRect(),i=s.left,l=s.right;i>=n&&l<o||e.style.setProperty("--custom-ellipsis-color",getComputedStyle(t,null).backgroundColor)}},s.prototype.addFakeCustomEllipsisIfNeeded=function(t,e){var r=t.getBoundingClientRect(),n=r.left,o=r.right,s=e.getBoundingClientRect(),i=s.left,l=s.right;if(!(i>=n&&l<o)){t.classList.add("fake-custom-ellipsis");var a=t.style.getPropertyValue("--custom-ellipsis-color"),c=getComputedStyle(e,null).backgroundColor;a!=c&&(this.fakeEllipsisOldColor[t]=a),t.style.setProperty("--custom-ellipsis-color",c),this.fakeEllipsisNodeDict[e]=t}},s.prototype.removeFakeCustomEllipsis=function(){for(var t=0,r=Object.entries(this.fakeEllipsisNodeDict);t<r.length;t++){var n=e(r[t],2),o=(n[0],n[1]),s=this.fakeEllipsisOldColor[o];s&&0!=s.length||o.classList.remove("fake-custom-ellipsis"),o.style.setProperty("--custom-ellipsis-color",s)}this.fakeEllipsisNodeDict={},this.fakeEllipsisOldColor={}},s}();exports.Search=l;
},{"./commands":"TnH5"}],"N3t7":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.TranslateRecommend=void 0;var e=require("./utils"),t=require("./commands"),n=function(){function n(e){this.recommendNodeStr='<div class="recommend-translate"><div class="translation-button recommend-translate-button"></div><span class="recommend-translate-border-line">|</span><svg class="recommend-translate-close" fill="none" height="18" viewBox="0 0 18 18" width="18" xmlns="http://www.w3.org/2000/svg"><path d="m9.0001 7.58579 6.7175-6.717511c.1953-.195262.5119-.195262.7071 0l.7071.707111c.1953.19526.1953.51184 0 .7071l-6.7175 6.71752 6.7175 6.71749c.1953.1953.1953.5119 0 .7071l-.7071.7071c-.1952.1953-.5118.1953-.7071 0l-6.7175-6.7175-6.71752 6.7175c-.19526.1953-.51184.1953-.7071 0l-.70711-.7071c-.195262-.1952-.195262-.5118 0-.7071l6.71752-6.71749-6.71752-6.71752c-.195262-.19526-.195262-.51184 0-.7071l.70711-.707111c.19526-.195262.51184-.195262.7071 0z" fill="#3370FF"/></svg></div>',this.buttonTitle=e}function r(t,n){if(!(0,e.isNull)(t)){var r=(0,e.$)('.message-item[message-id="'.concat(t,'"]')),a=r.querySelector(".translation-operation-bar");if(!(0,e.isNull)(a)){var o=r.querySelector(".translation-language");o&&o.classList.remove("showRecommend");var s=a.querySelector(".recommend-translate");s&&a.removeChild(s),n&&(0,e.hideDomElement)(a)}}}return n.prototype.show=function(t,n){if(!(0,e.isNull)(t)){var r=(0,e.$)('.message-item[message-id="'.concat(t,'"]')),a=r.querySelector(".translation-operation-bar");if(!(0,e.isNull)(a)){var o=a.querySelector(".recommend-translate");if(o||(o=(0,e.convertToNodeFirstElementByStr)(this.recommendNodeStr),a.appendChild(o)),o.querySelector(".recommend-translate-button").innerText=this.buttonTitle,(0,e.showDomElement)(a),n){var s=r.querySelector(".translation-language");(0,e.isNull)(s)||(s.classList.add("showRecommend"),s.innerText=n)}var i=a.querySelector(".translation-view-translation-button"),l=a.querySelector(".translation-view-original-button"),m=a.querySelector(".language-drop-down-icon");(0,e.hideDomElement)(i),(0,e.hideDomElement)(l),(0,e.hideDomElement)(m)}}},n.prototype.handleTranslateRecommendClick=function(e){var n=e.target;if(n.classList.contains("recommend-translate-button")){var a=n.closest(".message-item").getAttribute("message-id");return t.Commands.track("mail_translation_recommend_btn",{thread_id:window.t_id,message_id:a,banner_action:"accept"}),t.Commands.translate(a),!0}if(n.closest(".recommend-translate-close")){var o=n.closest(".message-item").getAttribute("message-id");return r(o,!0),t.Commands.track("mail_translation_recommend_btn",{thread_id:window.t_id,message_id:o,banner_action:"ignore"}),!0}return!1},n.prototype.remove=r,n}();exports.TranslateRecommend=n;
},{"./utils":"FOZT","./commands":"TnH5"}],"vpJJ":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.SafetyBanner=void 0;var e=require("./utils"),t=require("./commands"),a=function(){var a=0,n=1,s=2,o=3;function r(){}return r.handleSafatyBannerClick=function(e){if(e.target){var a=void 0;if(e.target.matches(".safety-tip-banner .safety-button.safety-report")?(console.log("tap on safety report"),a=t.Commands.reportMessage):e.target.matches(".safety-tip-banner .safety-button.safety-normal")?(console.log("tap on safety unmark"),a=t.Commands.trustMessage):e.target.matches(".safety-tip-banner .safety-banner-icon.close-btn")&&(console.log("tap on safety close"),a=t.Commands.closeSafetyBanner),a)return a(e.target.closest(".message-item").getAttribute("message-id")),!0}return!1},r.update=function(r,c,i){t.Commands.log("SafetyBanner ".concat(r,", isSuspect ").concat(c,", reportType ").concat(i));i=parseInt(i);if(r&&!isNaN(i)){var m=(0,e.$)('.message-item[message-id="'.concat(r,'"] .safety-tip-banner'));if(m)if(c)switch(i){case a:(0,e.showDomElement)(m);break;case n:(0,e.showDomElement)(m);var f=m.querySelector(".safety-buttons-container");f&&(0,e.hideDomElement)(f);break;case o:case s:(0,e.hideDomElement)(m)}else(0,e.hideDomElement)(m)}},r}();exports.SafetyBanner=a;
},{"./utils":"FOZT","./commands":"TnH5"}],"Focm":[function(require,module,exports) {
"use strict";var e=require("./avatar"),t=require("./utils"),n=require("./commands"),a=require("./renderQuote"),r=require("./popover"),o=require("./search"),i=require("./translateRecommend"),s=require("./safetyBanner");function l(e,t){var n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=c(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var a=0,r=function(){};return{s:r,n:function(){return a>=e.length?{done:!0}:{done:!1,value:e[a++]}},e:function(e){throw e},f:r}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,s=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){s=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(s)throw o}}}}function c(e,t){if(e){if("string"==typeof e)return d(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?d(e,t):void 0}}function d(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}n.Commands.log("after import",n.LogLevel.info);var m,u,g,f={normal:0,search:1},v={none:"0",request:"1",recalling:"2",completed:"3",allSuccess:"4",allFail:"5",someFail:"6"},h=[],p=null,y={},w={},L=new Set,b=void 0;function C(){return b=b||new t.ImageDownloadLogHelper}function S(e){for(var t=e.querySelectorAll(".banner-container"),n=0;n<t.length;n++){var a=t[n];new(MutationObserver||WebKitMutationObserver)(function(e,t){var n,a=l(e);try{for(a.s();!(n=a.n()).done;){var r=n.value;if(r.target.classList.contains("banner")&&r.target.parentElement.classList.contains("banner-container"))A(r.target.parentElement)}}catch(o){a.e(o)}finally{a.f()}}).observe(a,{attributes:!0,childList:!0,subtree:!0})}}function A(e){for(var n=e.querySelectorAll(".banner, .send-banner"),a=!1,r=0;r<n.length;r++){if(a=!getComputedStyle(n[r]).display.includes("none"))break}a?(0,t.showDomElement)(e):(0,t.hideDomElement)(e)}function k(){var e=[];if((0,t.isNull)(p))p=[],(0,t.$$)(".message-item.expand").forEach(function(t){q(t)?e.push(t):p.push(t.getAttribute("message-id"))});else if(p.length>0){e=[];var n=[];p.forEach(function(a){var r=(0,t.$)('.message-item.expand[message-id="'.concat(a,'"]'));q(r)?e.push(r):n.push(a)}),p=n}x(e)}function q(e){var t=e.getBoundingClientRect();return t.bottom>0&&t.bottom<window.innerHeight+t.height}function x(e){if(e&&e.length>0){var t=[];e.forEach(function(e){var n=e.getAttribute("message-id");n&&!h.includes(n)&&(h.push(n),t.push(n))}),t.length>0&&n.Commands.expandMessagesFirstVisible(t)}}function N(e){if(e){var t=e.querySelector(".recall_message_banner");if(t){var n=e.querySelector(".recallIcon"),a=t.getAttribute("recall_state");Te(t,n,a)}}}function T(){try{for(var e=(0,t.$$)(".message-label-item[labeldir=rtl]"),a=0;a<e.length;a++){var r=e[a];if((0,t.isAndroid)())r.style.direction="rtl";else if((0,t.isIOS)()&&r.scrollWidth>r.offsetWidth){var o=r.firstChild,i="..."+o.nodeValue;r.style.textOverflow="clip";for(var s=Array.from(i);r.scrollWidth>r.offsetWidth&&s.length>"...".length;)i="..."+s.slice("...".length+1).join(""),s=Array.from(i),o.nodeValue=i,o.innerHTML=i}}}catch(l){n.Commands.log("modifyLabelsRTL error:"+l,n.LogLevel.info)}}function E(){var e=(0,t.$)(".message-flag-button");e&&e.addEventListener("click",function(t){e.classList.contains("is-flagged")?e.classList.remove("is-flagged"):e.classList.add("is-flagged"),n.Commands.clickFlag(),t.stopPropagation()})}function _(e){e.removeEventListener("touchstart",I),e.removeEventListener("click",O),e.addEventListener("touchstart",I),e.addEventListener("click",O);var t=e.querySelector(".item-content");t&&(P(t),ye(t),pe(t))}var $=!1,B=!0;function I(e){$&&!(0,t.isIOS)()?B=!1:(B=!0,re(e))}function O(e){if(!B)return n.Commands.log("messageItemClick blocked by scrolling"),void(B=!0);var t=oe(e);t||(t=ie(e))||(t=se(e))||(K(e),ae(e),le(e),ge(e),H(e)||ce(e)||ue(e)||kt&&kt.handleTranslateRecommendClick(e)||ne(e)||D(e)||s.SafetyBanner.handleSafatyBannerClick(e)||M(e))}function M(e){if(e.target&&(e.target.classList.contains("lk-redirect-btn")||e.target.matches(".lk-redirect-btn *"))){var t=e.target.closest(".lk-redirect-banner");t&&(t.classList.contains("expand")?t.classList.remove("expand"):t.classList.add("expand"))}}function D(e){if(e.target&&(e.target.matches(".loading_container.show_error")||e.target.matches(".loading_container.show_error *"))){n.Commands.log("tap on error img");var t=e.target.closest(".loading_container.show_error");if(t)return n.Commands.log("handleErrorImgRetry"),yt(t.querySelector("img")),!0}return!1}function H(e){F(e.target)}function F(e){if((e=e).parentNode&&"true"==e.parentNode.getAttribute("larkmailquote")&&(e=e.parentNode),e&&"true"==e.getAttribute("larkmailquote")){var n="collapse"+(0,t.getQuoteClassPostfix)(e),a=e.closest(".quoteControlRoot");if(a){var r=window.scrollY;a.classList.contains(n)?a.classList.remove(n):a.classList.add(n),r!=window.scrollY&&window.scrollTo(0,r)}var o=e.closest(".message-item").querySelector(".is_body_clipped");return o&&(a.classList.contains(n)?o.style.display="none":o.style.display="flex"),!0}}function R(e){e.addEventListener("touchstart",function(e){re(e)}),e.addEventListener("click",function(e){var t=he(e);t||(t=Q(e))})}function P(e){for(var t=e.querySelectorAll(".address-list"),n=0;n<t.length;n++){t[n].addEventListener("click",function(e){fe(e)})}}function W(e){for(var t=e.querySelectorAll(".send-status-bar"),n=0;n<t.length;n++){t[n].addEventListener("click",function(e){j(e)})}}function j(e){n.Commands.log("handleSendStatusBannerClick",n.LogLevel.info);var t=e.target.closest(".message-item");if(t){var a=t.getAttribute("message-id");n.Commands.sendStatusClick(a)}}function V(){for(var e=(0,t.$$)(".smart-reply-group"),n=0;n<e.length;n++){e[n].addEventListener("click",function(e){ve(e)})}}function U(e){for(var t=e.querySelectorAll(".calender-action"),a=0;a<t.length;a++){t[a].addEventListener("click",function(e){z(e),e.stopPropagation()})}var r=e.querySelectorAll(".card-event-detail");for(a=0;a<r.length;a++){r[a].addEventListener("click",function(e){var t=e.target.closest(".message-item");if(t){var a=t.getAttribute("message-id");n.Commands.showCalendarDetail(a),n.Commands.log("showCalendarDetail"+a,n.LogLevel.info)}})}}function z(e){var a=e.target.closest(".calender-action");if(!a.classList.contains("active")){for(var r=(0,t.$$)(".calender-action"),o=0;o<r.length;o++){r[o].classList.remove("active")}var i=a.closest(".message-item");if(i){var s=i.getAttribute("message-id"),l=a.getAttribute("data-action");switch(a.classList.add("active"),n.Commands.log("handleCalendarAction | "+l+" | "+s,n.LogLevel.info),l){case"accept":n.Commands.acceptCalendar(s);break;case"refuse":n.Commands.refuseCalendar(s);break;case"pending":n.Commands.pendingCalendar(s)}}}}function Y(e){var t=e.closest(".fold-draft-item");if(void 0!==t){var a=t.getAttribute("draft-id"),r=t.getAttribute("reply-message-id");n.Commands.clickDraft(a,r)}return!0}function Q(e){if(!e.target.closest(".fold-draft-item"))return!1;Y(e.target)}var Z={},J={};function K(e){if(!(e.target.closest(".fold-draft-item")||e.target.closest(".recipients_container")||e.target.closest(".context-menu"))&&(e.target.closest(".header-content")||e.target.classList.contains("item-header"))){var a=e.target.closest(".message-item"),r=a.getAttribute("message-id");J[r]&&(J[r].disconnect(),J[r]=null);var o=a.querySelector(".attachment-tag"),i={x:e.clientX,y:e.clientY},s=o&&(0,t.pointInsideRect)(o.getBoundingClientRect(),i,{top:-4,right:-4,bottom:-4,left:-4});if(a.classList.contains("expand")){if(s)ee(a);else if("isforward"===window.isforward||!e.target.closest(".message-item:last-child")){a.classList.remove("expand"),a.classList.remove("half-expand");r=a.getAttribute("message-id");n.Commands.messageclick(r,!1,!1);var l=a.querySelector(".message-attachments-wrapper.expand");l&&l.classList.remove("expand")}}else{var c=(0,t.isNull)(a.querySelector(".item-content"));a.classList.add("expand"),n.Commands.messageclick(r,!0,c),c?(s&&a.classList.add("scrollToAttachment"),X(a,r)):(_t&&!Et[r]&&Ht(a),x([a]),s&&ee(a))}}}function X(e,t){Z[t]=Date.now();var a=new MutationObserver(function(r){var o=e.querySelector(".item-content"),i=Z[t];if(i){if(o&&e.classList.contains("expand")&&"none"!=getComputedStyle(o).display){var s=Date.now()-i;n.Commands.track("email_additemcontent_delay",{delay:s}),n.Commands.log("email_additemcontent_delay ".concat(s,"ms"),n.LogLevel.info),Z[t]=null,J[t]=null,a.disconnect(),_t&&!Et[t]&&Ht(e),e.classList.contains("scrollToAttachment")&&(e.classList.remove("scrollToAttachment"),setTimeout(function(){ee(e)},0))}}else a.disconnect()});a.observe(e,{attributes:!0,childList:!0,characterData:!1,subtree:!0}),J[t]=a}function G(e,n,a){var r=Ut(e);if(r){if(r.querySelector(".item-content"))return;var o=(0,t.convertToNodeFirstElementByStr)(n);r.appendChild(o),(0,t.$$)("table img").length>0&&Je(),Se(r),bt(r),x([r]),a&&a(o)}}function ee(e){var t=e.querySelector(".item-footer-card.attachments");if(t){n.Commands.track("email_attachment_anchor_point_click");var a=e.querySelector(".message-attachments-wrapper");a&&a.classList.add("expand"),te(t,140)}}function te(e,a,r){if(e){a=(a||0)+(parseFloat((0,t.$)(".message-header").style.paddingTop)||0);var o=e.getBoundingClientRect(),i=o.top>a&&o.bottom>window.innerHeight,s=o.top<a,l=o.left<16,c=o.right>window.screen.width-16;if(!l&&!c||r)if(s||i){var d=o.top-a,m=parseInt(Math.min(window.pageYOffset+d,document.documentElement.scrollHeight-window.innerHeight));m=Math.max(0,m),n.Commands.log("scroll to targetY ".concat(m,", outOfBottom ").concat(i,", outOfTop ").concat(s,", rectTop ").concat(o.top,", topOffset ").concat(a),!0),n.Commands.scrollTo(m)}else n.Commands.log("dont scroll to targetY, outOfBottom ".concat(i,", outOfTop ").concat(s),!0);else{var u=(0,t.getChromeVer)();u&&u<=60?(e.scrollIntoViewIfNeeded(),n.Commands.log("scrollIntoViewIfNeeded outOfLeft ".concat(l,", outOfRight ").concat(c),!0)):(e.scrollIntoView({behavior:"smooth",block:"center",inline:"center"}),n.Commands.log("scrollIntoView outOfLeft ".concat(l,", outOfRight ").concat(c),!0))}}}function ne(e){var t=e.target;if(t.classList.contains("schedule-view-original-button")){var a=t.closest(".message-item").getAttribute("message-id");return n.Commands.track("mail_schedule_send_cancel_btn",{thread_id:window.t_id,message_id:a,banner_action:"accept"}),n.Commands.cancelScheduleSendClick(a),!0}return!1}function ae(e){var a=e.target.closest(".context-menu");if(a){var r=e.target.closest(".message-item"),o=r.getAttribute("message-id"),i=r.querySelector(".translation-operation-bar"),s=r.querySelector(".avatar"),l=s.style.background,c=s.innerText;if(l&&c&&(l=l.substring(4,l.length-1).replace(/ /g,"").split(",").map(function(e){return parseFloat(e)})).length>=3)var d={rgb:l,initial:c};var m=!1;i&&(0,t.isNull)(i.querySelector(".showRecommend"))&&"none"!=getComputedStyle(i).display&&(m=!0);var u=(0,t.isPad)()?(0,t.getElementFrame)(a):void 0;It(),n.Commands.contextMenuClick(window.t_id,o,m,d,u)}}function re(e){var t=e.target.closest(".recipients");return!!t&&(t.classList.add("touchstart"),!0)}function oe(e){var t=e.target,a=t.closest(".recipients"),r=t.closest(".message-item"),o="";if(r&&(o=r.getAttribute("message-id")),a){if(a.classList.remove("touchstart"),a.classList.contains("expand")){a.classList.remove("expand");var i=t.closest(".message-item").querySelector(".recipients-expand");return i&&i.classList.remove("show"),a.querySelector(".address-icon-fold").classList.remove("show"),a.querySelector(".address-icon-fold").classList.add("hide"),a.querySelector(".address-icon-unfold").classList.remove("hide"),a.querySelector(".address-icon-unfold").classList.add("show"),e.stopPropagation(),n.Commands.receiverClick(o,!1),!0}if(a){a.classList.add("expand");var s=t.closest(".message-item").querySelector(".recipients-expand");s&&s.classList.add("show")}return a.querySelector(".address-icon-fold").classList.remove("hide"),a.querySelector(".address-icon-fold").classList.add("show"),a.querySelector(".address-icon-unfold").classList.remove("show"),a.querySelector(".address-icon-unfold").classList.add("hide"),e.stopPropagation(),n.Commands.receiverClick(o,!0),!0}return!1}function ie(e){var t=e.target.closest(".avatar");if(t){var a=t.getAttribute("user-id"),r=t.getAttribute("user-type")||"1",o=t.getAttribute("tenant-id")||"",i=t.getAttribute("user-address")||"",s=t.getAttribute("user-name");return(void 0===a||null==a||"0"==a||a.length<1)&&(a=""),It(),n.Commands.avatarimageclick(a,i,s,r,o),!0}return!1}function se(e){n.Commands.log("handle read more button",n.LogLevel.info);var t=e.target,a=t.closest(".message-item");if(t&&a){var r=t.getAttribute("data-action");r||((t=t.closest(".read_more_button"))?r=t.getAttribute("data-action"):n.Commands.log("handleReadMoreButton read_more_button target not found",n.LogLevel.error));var o=a.getAttribute("message-id");switch(n.Commands.log("action:"+r+"|messageId:"+o,n.LogLevel.info),r){case"readmore":return n.Commands.readmoreMessage(o),!0}}else t||n.Commands.log("handleReadMoreButton target error",n.LogLevel.error),a||n.Commands.log("handleReadMoreButton messageItem error",n.LogLevel.error);return!1}function le(e){var t=e.target;if(t.closest(".attachment")){var a=t.closest(".attachment");if(a){var r=a.getAttribute("file-token"),o=a.getAttribute("file-url");It(),n.Commands.openAttachment(r,o)}}}function ce(e){var t=e.target;if("img"===t.tagName.toLowerCase()&&!t.closest(".swiper-slide")){var a=t.getAttribute("src");if(0===t.src.indexOf("cid:")){for(var r={src:t.src.replace("cid:","")},o=t.closest(".message-item").querySelectorAll(".message-content img"),i=[],s=0,l=o.length;s<l;s++){var c=o[s];0===c.src.indexOf("cid:")&&i.push({src:c.src.replace("cid:","")})}return It(),n.Commands.clickImage(r,i),!0}if(0===t.src.indexOf("http")){if(0==de(t))return It(),n.Commands.clickImage({httpSrc:t.src}),!0}else if(0===a.indexOf("file:")){It();var d={localPath:t.src},m=[d];return n.Commands.clickImage(d,m),!0}}return!1}function de(e){return"body"!=e.tagName.toLowerCase()&&("a"==e.tagName.toLowerCase()?e.href.length>0:de(e.parentNode))}window.addItemContent=function(e){var t=JSON.parse(e);if(t)for(var n in t){if(n)G(n,t[n])}},window.togglePopover=function(e,t){var n=parseInt(e);me=me||new r.Popover(window.translatePopoverTitle),!isNaN(n)&&n?t&&me.showWithBody(t):me.close()};var me=null;function ue(e){var t,n,a=e.target;if(a.classList.contains("subject-translation")){var o=a.parentNode.querySelector(".message-subject");o&&(t=a,n=o)}else{var i=a.closest(".translated-message-content");if(i&&i.classList.contains("showPopover")){var s=a.closest('[data-translate-type="0"]')||a.querySelector('[data-translate-type="0"]');if(s){var l=i.closest(".message-item"),c=s.getAttribute("data-translate-id");n=l.querySelector('[data-translate-id="'.concat(c,'"]')),t=s,"a"==a.tagName.toLowerCase()&&null==a.closest(".selected-translation")&&e.preventDefault()}}}return!(!t||!n)&&((me=me||new r.Popover(window.translatePopoverTitle)).show(t,n),!0)}function ge(e){var t=e.target;if(t.closest(".recall-message-detail")){var a=t.closest(".message-item");if(a){var r=a.getAttribute("message-id");n.Commands.recallDetail(r),n.Commands.track("email_mail_recall_result_banner_click",{click:"check_detail",target:"none"})}}}function fe(e){n.Commands.log("handleAddressList",n.LogLevel.info);var a=e.target.closest(".address-item");if(a){var r=a.getAttribute("user-id"),o=a.getAttribute("user-type")||"1",i=a.getAttribute("tenant-id")||"";(void 0===r||null==r||"0"==r||r.length<1)&&(r="");var s=a.querySelector(".address"),l=a.querySelector(".name");if(s){var c=(0,t.isPad)()?(0,t.getElementFrame)(a):void 0;n.Commands.addressclick(s.innerText,r,c,l.innerText,o,i)}else n.Commands.log("handleAddressList .address not found",n.LogLevel.info)}else n.Commands.log("handleAddressList .address-item not found",n.LogLevel.info)}function ve(e){var t=e.target,a=t.innerText,r=t.getAttribute("index");n.Commands.smartReply(a,r)}function he(e){var t=e.target.closest(".draft-delete");if(t){var a=t.getAttribute("draft-id"),r=t.getAttribute("thread-id");return n.Commands.deleteDraft(a,r),e.stopPropagation(),!0}return!1}function pe(e){if(e){var t=e.querySelector("._3+.attachments-show-more");t&&t.addEventListener("click",function(e){var t=e.target.closest(".message-attachments-wrapper");if(t){t.classList.add("expand");var n=t.querySelectorAll(".attachment-item-wrapper");if(n.length>0)n[n.length-1].scrollIntoViewIfNeeded()}})}}function ye(e){if(!(0,t.isNull)(e)){var a=e.querySelector(".translation-operation-bar");if(!(0,t.isNull)(a)){var r=e.closest(".message-item").getAttribute("message-id");if(!(0,t.isNull)(r)){var o=a.querySelector(".language-container");(0,t.isNull)(o)||o.addEventListener("click",function(e){e.target.closest(".showRecommend")||(n.Commands.log("addHandlerToTranslation translationLanguageButton",n.LogLevel.info),n.Commands.selectTranslationLanguageClick(r))});var i=a.querySelector(".translation-view-original-button");(0,t.isNull)(i)||i.addEventListener("click",function(e){n.Commands.log("addHandlerToTranslation viewOriginalButton",n.LogLevel.info),n.Commands.viewOriginalClick(r)});var s=a.querySelector(".translation-view-translation-button");(0,t.isNull)(s)||s.addEventListener("click",function(e){n.Commands.log("addHandlerToTranslation viewTranslationButton",n.LogLevel.info),n.Commands.viewTranslationClick(r)})}}}}function we(e){return"string"==typeof e&&"true"===e.toLowerCase()||("boolean"==typeof e&&!0===e||"number"==typeof e&&0!==e)}function Le(e,n){(0,t.isNull)(e)||(0,t.isNull)(n)||e.classList.contains(n)||e.classList.add(n)}function be(e,n){if(!(0,t.isNull)(e)&&!(0,t.isNull)(n))for(;e.classList.contains(n);)e.classList.remove(n)}function Ce(e,a){var r=(0,t.isNull)(e.querySelector(".item-content"));e.classList.add("expand"),r&&a&&n.Commands.needContents([a],f.normal)}function Se(t,a){try{if(t.classList.contains("message-item")){(0,e.updateAvatar)(t),t.getAttribute("reply-message-id")?R(t):_(t),st(t.querySelector(".item-header")),st(t.querySelector(".recipients-expand")),S(t),W(t),U(t),N(t);var r=t.querySelector(".original-message-content"),o=t.querySelector(".message-attachments-wrapper");n.Commands.log("from simple search, attachment node: "+o),Ae(r,o,a),ct(t)}}catch(i){n.Commands.log("initMessageNode error:"+i,n.LogLevel.info)}}function Ae(e,t,r){try{if(!r)r=document.querySelector(".message-list").children;if(e&&r){var o=1!==r.length;(0,a.renderContentAndQuoteForMessage)(e,o),st(e),t&&void 0!==window.keyword&&window.keyword.length>0&&(Zt(t,window.keyword),st(t)),mt(e),St(e),ut(e)}}catch(i){n.Commands.log("initMessageContent error:"+i,n.LogLevel.info)}}function ke(e){if(e){var t=Math.min(e.clientWidth||document.body.clientWidth-16-16,450)/(343/257),n=parseFloat(e.style.height);t>0&&(!n||n!=t)&&document.querySelectorAll(".swiper-container").forEach(function(e){e.style.height="".concat(t,"px")})}}function qe(e,t){for(var n=e.querySelectorAll("a"),a=0;a<n.length;a++)for(var r=n[a],o=r.getAttribute("href"),i=0;i<t.length;i++){var s=t[i];if(o==s.url&&r.innerText.trim().length>0){r.classList.add("lk-docs-icon");var l=xe[s.type];if(r.classList.add(l),o.trim()==r.innerText.trim()){r.innerText=s.name;break}}}}window.updateMenuItem=function(e,n){var a=Ut(e),r=(0,t.convertToNodeFirstElementByStr)(n),o=a.getElementsByClassName("menu");1==o.length&&o[0].replaceWith(r)},window.hideSmartReply=function(){(0,t.$)(".smart-reply-group").style.display="none"},window.showSmartReply=function(e){if(e.length<3)n.Commands.log("must have more than or equeal to 3 words",n.LogLevel.error);else{(0,t.$)(".smart-reply-group").style.display="flex";for(var a=(0,t.$$)(".smart-reply-button"),r=0;r<a.length;r++)a[r].innerText=e[r]}},window.updateFlagged=function(e,n){var a=(0,t.$)(".message-flag-button");void 0!==a&&(we(n)?a.classList.add("is-hidden"):(a.classList.contains("is-hidden")&&a.classList.remove("is-hidden"),we(e)?a.classList.add("is-flagged"):a.classList.contains("is-flagged")&&a.classList.remove("is-flagged")))},window.updateDraft=function(a,r){for(var o=Ee(a),i=0;i<o.length;i++)o[i].remove();var s=Ut(a),l=s.closest(".message-list"),c=(0,t.convertToNodeFirstElementByStr)(r);(0,e.updateAvatar)(c),n.Commands.checkUserids((0,e.getAvatarUserids)()),l.insertBefore(c,s.nextElementSibling),c.querySelector("a.show-hightlight").addEventListener("click",function(e){n.Commands.log("needShowHightLightItem click",n.LogLevel.info),he(e)||Y(e.target)})},window.deleteDraft=function(e){try{var t=_e(e);if(null==t)return void n.Commands.log("draftItem null",n.LogLevel.error);var a=t.closest(".message-list"),r=t.closest(".message-item");a.removeChild(r)}catch(o){n.Commands.log("deleteDraft error:"+o,n.LogLevel.error)}},window.deleteMessage=function(e){if(e){var n=(0,t.$)('[message-id="'.concat(e,'"]'));n&&n.parentNode.removeChild(n)}},window.updateMessage=function(a){try{n.Commands.log("updateMessage",n.LogLevel.info);var r=document.querySelector(".message-list");if(r){n.Commands.log("updateMessage run",n.LogLevel.info);var o=(0,t.convertToNodeFirstElementByStr)(a);r.appendChild(o),Se(o,r.children),bt(o),Ht(o),n.Commands.checkUserids((0,e.getAvatarUserids)())}}catch(i){n.Commands.log("updateMessage error:"+i,n.LogLevel.info)}},window.removeMessage=function(e,a){try{n.Commands.log("RemoveMessage ".concat(e,", expandNext ").concat(a));var r=Ut(e);if(r&&r.parentElement)if(r.matches(".message-item:last-child"))n.Commands.log("RemoveMessage last"),r.parentElement.removeChild(r),(o=(0,t.$)(".message-item:last-child"))&&Ce(o,o.getAttribute("message-id"));else if(a){n.Commands.log("RemoveMessage expandNext");var o,i=(0,t.$)('.message-item[message-id="'.concat(e,'"] + .message-item'));r.parentElement.removeChild(r),(o=i||(0,t.$)(".message-item:last-child"))&&!o.classList.contains("expand")&&Ce(o,o.getAttribute("message-id"))}else n.Commands.log("RemoveMessage just delete"),r.parentElement.removeChild(r)}catch(s){n.Commands.log("removeMessage error:"+s,n.LogLevel.info,!0)}},window.updateLabels=function(e){var a=function(e){return null!=e},r=(0,t.$)(".message-title"),o=r.cloneNode(),i=(0,t.$)("#message-subject-container"),s=(0,t.$)(".message-external-item");if(a(r)){o.innerHTML=e;var l=o.firstChild;a(s)&&(a(l)?o.insertBefore(s,l):o.appendChild(s)),l=o.firstChild,a(i)&&(a(l)?o.insertBefore(i,l):o.appendChild(i))}r.parentNode.replaceChild(o,r);for(var c=(0,t.$$)(".message-label-item"),d=function(e){var t=c[e];t.addEventListener("click",function(e){n.Commands.clickLabel(t.innerText)})},m=0;m<c.length;m++)d(m);T()},window.updateDocsItem=function(e){var n=JSON.parse(e),a=0;for(var r in n){var o=n[r];if(!(o.length<1)){for(var i=(0,t.$$)("section[message-id]"),s=0;s<i.length;s++){var l=i[s];if(l.getAttribute("message-id")==r){var c="messageID"+a;l.querySelectorAll(".message-content").forEach(function(e){qe(e,o)});var d=l.querySelector(".item-content"),m=d.querySelector(".content-footer-card");if(null==d.querySelector(".swiper-container#".concat(c))){var u=Ne(o,c);m.insertBefore(u,m.firstChild);var g=l,f=!1;if(g.className.indexOf(" expand")<0&&(g.className+=" expand",f=!0),new Swiper({el:"#"+c,initialSlide:0,spaceBetween:5,slidesPerView:1,scrollbar:{el:"#"+c+" .swiper-scrollbar"},loop:!1,pagination:{el:"#"+c+" .swiper-pagination"}}),f){var v=g.className.replace(" expand"," ");g.className=v}}}}a++}}};var xe=["lk-unknown","lk-doc","lk-sheet","lk-bitable","lk-mindnote","lk-file","lk-slide","lk-wiki","lk-docx"];function Ne(e,n){for(var a='<div class="swiper-container swiper-container-initialized swiper-container-horizontal item-footer-card" id="'+n+'"><div class="swiper-wrapper">',r=0;r<e.length;r++){a=(a=(a=(a=(a+='<div class="swiper-slide" onclick="window.location=\''+(o=e[r]).url+'\'"><div class="swiper-docs-container"><div class="swiper-docs-top $icon_type$"><span class="swiper-docs-title">$name$</span></div><div class="swiper-docs-preview"><img src="$abstract$"/></div><div class="swiper-docs-owner">'+window.ownerwording+'$ownerName$</div><div class="swiper-docs-horizontal-bar"></div><div class="swiper-docs-vertical-bar"></div></div></div>').replace("$icon_type$",xe[o.type])).replace("$name$",o.name)).replace("$abstract$",o.abstract)).replace("$ownerName$",o.ownerName)}a+="</div>",a+='<div class="swiper-pagination swiper-pagination-bullets">';for(r=0;r<e.length;r++){var o=e[r];a+='<span class="swiper-pagination-bullet"></span>'}a+="</div>",a+="</div>";var i=(0,t.convertToNodeFirstElementByStr)(a);return new(MutationObserver||WebKitMutationObserver)(function(e,t){ke(i)}).observe(i,{attributes:!0,childList:!1,subtree:!0}),i}function Te(e,a,r,o){var i=String(r);if(n.Commands.log("UpdateRecall: state ".concat(r)),e&&null!=i){var s=e.getAttribute("recall_state");e.setAttribute("recall_state",i);var l="none",c="none",d="none",m="",u=e.querySelector("#recall-icon"),g=e.querySelector(".recall-message-detail"),f=getComputedStyle(g).height;switch(f&&(u.style.height=f),i){case v.none:e.style.display="none",l="none",c="none",d="none",m=0==m.length?"unknown":m;break;case v.request:e.style.display="flex",l="flex",c="inline-block",d="none",e.querySelector(".storybook-spinner").style.display="flex",g.style.display="none",u.style.display="none";break;case v.recalling:e.style.display="flex",l="flex",c="inline-block",d="none",e.querySelector(".storybook-spinner").style.display="flex",g.style.display="inline-block",u.style.display="none";break;case v.allFail:m=0==m.length?"all_failed":m;case v.allSuccess:m=0==m.length?"all_success":m;case v.someFail:m=0==m.length?"partial_success":m;case v.completed:e.style.display="flex",l="flex",c="none",d="inline-block",e.querySelector(".storybook-spinner").style.display="none",g.style.display="inline-block",u.style.display="block"}!(0,t.isNull)(s)&&(i!=s||!e.hasInitLog&&i!=v.none)&&m.length>0&&(n.Commands.track("email_mail_recall_result_banner_view",{result:m}),e.hasInitLog=!0),a&&(a.style.display=l);var h=e.querySelector("#recalling-banner");h?(h.style.display=c,o&&"none"!=c&&(h.innerText=o)):n.Commands.log("Updating recall state UI recalling-banner not found ",n.LogLevel.info);var p=e.querySelector("#completed-banner");p?(p.style.display=d,o&&"none"!=d&&(p.innerText=o)):n.Commands.log("Updating recall state UI completed-banner not found ",n.LogLevel.info)}}function Ee(e){for(var t=new Array,n=document.getElementsByClassName("message-item"),a=0;a<n.length;a++){var r=n[a];e===r.getAttribute("reply-message-id")&&t.push(r)}return t}function _e(e){for(var t=document.getElementsByClassName("fold-draft-item"),n=0;n<t.length;n++){var a=t[n];if(e==a.getAttribute("draft-id"))return a}}window.updateUserid=function(a){try{for(var r=JSON.parse(a),o=(0,t.$$)("div.avatar"),i=0;i<o.length;i++){var s=o[i],l=s.getAttribute("user-id");if(!(void 0===l||null==l||"0"==l||l.length<1)&&r.userid==l){var c=s.getElementsByTagName("img");if(void 0===c||c.length<1){var d=r.avatarurl;void 0===d||null==d||d.length<1?(0,e.updateAvatar)(s.parentNode,!0):s.innerHTML='<img src="'+r.avatarurl+'" height="40" width="40" />'}}}}catch(m){n.Commands.log("updateUserid error:"+m,n.LogLevel.info)}},window.unfoldallmessage=function(){for(var e=(0,t.$$)("div.message-list section.message-item"),n=0;n<e.length;n++){e[n].classList.add("expand")}},window.foldallmessage=function(){for(var e=(0,t.$$)("div.message-list section.message-item"),n=0;n<e.length;n++){e[n].classList.remove("expand")}},window.updateRecallState=function(e,n,a){if(e){var r=(0,t.$)('[message-id="'.concat(e,'"]'));if(r)Te(r.querySelector(".recall_message_banner"),r.querySelector("#recall-tag"),n,a)}},window.updateSendState=function(e,n){if(e){var a=(0,t.$)('[message-id="'.concat(e,'"]'));if(a){var r=a.querySelector(".send-status-bar");if(r){var o=(0,t.convertToNodeFirstElementByStr)(n);r.style.display="flex",r.innerHTML=o.innerHTML}}}},window.hideSendStatus=function(e){if(e){var n=(0,t.$)('[message-id="'.concat(e,'"]'));if(n){var a=n.querySelector(".send-status-bar");a&&(a.style.display="none")}}};for(var $e=(0,t.$$)(".message-label-item"),Be=function(e){var t=$e[e];t.addEventListener("click",function(e){n.Commands.clickLabel(t.innerText)})},Ie=0;Ie<$e.length;Ie++)Be(Ie);T();for(var Oe=(0,t.$$)(".show-hightlight"),Me=0;Me<Oe.length;Me++){var De=Oe[Me];De.addEventListener("click",function(e){n.Commands.log("needShowHightLightItem click",n.LogLevel.info)})}function He(e,t){return Object.prototype.toString.call(e)==="[object "+(t||"Object")+"]"}function Fe(e){var t=e.stack.replace(/\n/gi,"").split(/\bat\b/).slice(0,9).join("@").replace(/\?[^:]+/gi,""),n=e.toString();return t.indexOf(n)<0&&(t=n+"@"+t),t}function Re(){if(!m){var e=(0,t.$)("meta[name=screenwidth]");m=parseInt(e.getAttribute("value"))}return m}function Pe(){return u||(u=parseFloat(getComputedStyle(document.querySelector(".message-item.expand .item-content")).width)),u}function We(e){var t=getComputedStyle(e),n=(parseFloat(t.marginLeft)||0)+(parseFloat(t.marginRight)||0);"content-box"==t.boxSizing&&(n=(n=n+(parseFloat(t.paddingLeft)||0)+(parseFloat(t.paddingRight)||0))+(parseFloat(t.borderLeftWidth)||0)+(parseFloat(t.borderRightWidth)||0)),e.style.maxWidth=n>0?"calc(100% - ".concat(n,"px"):"100%"}function je(){Ye(),(0,t.$)("table img")?Je():Ke();for(var e=document.getElementsByTagName("table"),a=0;a<=e.length-1;a++)e[a].style.maxWidth="none";setTimeout(function(){n.Commands.fixScaleFinish()},1)}function Ve(e){return{width:e.getAttribute("data-realwidth"),height:e.getAttribute("data-realheight")}}function Ue(e){return{width:parseFloat(e.getAttribute("width")),height:parseFloat(e.getAttribute("height"))}}function ze(e){var n=Ve(e),a=n.width,r=n.height,o=Ue(e),i=o.width,s=o.height;if(((0,t.isNullOrNaN)(a)||(0,t.isNullOrNaN)(r))&&(a=160,r=160,(0,t.isNullOrNaN)(s)||(0,t.isNullOrNaN)(i)))return{width:a,height:r};var l=Pe(),c=parseInt(e.style.width)||parseInt(e.getAttribute("width")),d=e.style.width.indexOf("%")>-1;c&&d&&(c=l*c/100);var m=parseInt(e.style.height)||parseInt(e.getAttribute("height")),u=e.style.height.indexOf("%")>-1;return(0,t.isNullOrNaN)(c)?(0,t.isNullOrNaN)(m)||u?(c=a,m=r):c=m/r*a:((0,t.isNullOrNaN)(m)||u)&&(m=c/a*r),l&&c>l&&(m*=l/c,c=l),{width:c,height:m}}function Ye(){var e=Pe();(0,t.$$)(".message-content").forEach(function(t){t.querySelectorAll("*[style]").forEach(function(t){if(t.style.width||t.style.minWidth){var n=parseInt(t.style.width),a=parseInt(t.style.minWidth),r=!isNaN(n)&&n>e,o=!isNaN(a)&&a>e;(r||o)&&null==t.closest("div[id^=large-file-area], .mTableArea")&&(r&&(t.style.maxWidth=t.style.width),o&&(t.style.maxWidth=t.style.minWidth,t.style.minWidth=""),t.style.width="100%",t.style.height="auto")}t.style.height&&t.scrollHeight>t.clientHeight&&"scroll"!==getComputedStyle(t).overflowY&&(t.style.height="auto")})})}window.onerror=function(e,t,a,r,o){var i=e;o&&o.stack&&(i=Fe(o)),He(i,"Event")&&(i+=i.type?"--"+i.type+"--"+(i.target?i.target.tagName+"::"+i.target.src:""):""),n.Commands.log("js error:"+i+",url:"+t+",line:"+a+",col:"+r+",error:"+o,n.LogLevel.info);var s={title:"error",msg:i,category:"js_error",col:r.toString(),line:a.toString()};n.Commands.track("mail_webview_javascript_error",s)},window.loadImgSuccess=function(e){for(var n=e.src,a=(0,t.$$)("div.message-content img"),r=0;r<a.length;r++)a[r].src!=n&&a[r].getAttribute("loading")!=n||(a[r].removeAttribute("loading"),a[r].onImgLoad())};var Qe,Ze=0;function Je(){for(var e=(0,t.$$)(".mTableArea"),a=0,r=e.length;a<r;a++){var o=e[a];if(!o.matches(".mTableArea .mTableArea")){var i=getComputedStyle(o);if(o.closest(".message-item").classList.contains("expand")&&!o.classList.contains("hasFixed")&&(null!=o.offsetParent||"fixed"===i.position)&&"none"!==i.display){var s="TABLE"==o.firstChild.tagName,l=o.querySelector("table"),c=l.scrollWidth,d=l.querySelectorAll("tr"),m=o.clientWidth/(c+5);if(0==o.clientWidth&&Ze<4){var u=100;return 4===(Ze+=1)&&(u=8e3,n.Commands.track("email_message_table_scale_delay")),void setTimeout(function(){Je()},u)}var g=0;s||(g=o.clientHeight-l.clientHeight)>30&&(g=30);var f=m<1;if(f&&null!=d&&d.length>0){var v=Array.from(d[0].querySelectorAll("td")).filter(function(e){return e.parentNode===d[0]});null!=v&&v.length>4&&(f=!1)}if(f){for(var h=l.querySelectorAll("td"),p=0,y=h.length;p<y;p++){var w=h[p],L=parseFloat(w.style.fontSize);if(L){var b=w.style.fontSize.replace("".concat(L),"".concat(L/m));w.style.setProperty("font-size",b,"important");var C=parseFloat(w.style.lineHeight);if(C){var S=w.style.lineHeight.replace("".concat(C),"".concat(C/m));w.style.setProperty("line-height",S,"important")}w.querySelectorAll("*").forEach(function(e){e.style.lineHeight="",e.style.fontSize=""}),w.style.height&&(w.style.minHeight=w.style.height,w.style.height="");var A=w.closest("tr");A.style.height&&(A.style.minHeight=A.style.height,A.style.height="")}}var k=100*(1-m)/(2*m);l.style.webkitTransform="scale("+m+") translate(-"+k+"%,-"+k+"%)",l.style.marginLeft="0",l.style.marginRight="0",l.style.borderCollapse="separate",l.style.borderSpacing="0";for(var q=l.scrollHeight*m+(0,t.getBorderHeight)(l),x=o.children,N=0;N<x.length;N++)x[N]!==l&&(q+=x[N].scrollHeight+(0,t.getBorderHeight)(l));o.style.cssText=q>0?"height:"+(q+g)+"px !important;overflow:visible;":"overflow:visible;"}o.classList.add("hasFixed")}}}}function Ke(){for(var e=(0,t.$$)(".mTableArea"),n=0,a=e.length;n<a;n++){var r=e[n],o=r.querySelector("table");r.style.cssText="height:auto;",r.className="",o.style.webkitTransform="",r.style.overflow="scroll"}}function Xe(){n.Commands.log("document.readyState:"+document.readyState,n.LogLevel.info),Ge(),et(),nt(),tt()}function Ge(){var e=parseInt((0,t.$)(".message-header").style.paddingTop);if(window.initAnchorPoint.length>1&&!window.initAnchorPoint.includes("init_anchor_point"))window.location.hash=initAnchorPoint;else if("true"==window.enableLocateToExpand)for(var a=document.querySelectorAll(".message-item"),r=0;r<a.length;r++){var o=a[r];if(o.classList.contains("expand")){if(0!=r){var i=e||0;g=o.offsetTop-32-i,document.body.scrollTop=g,document.documentElement.scrollTop=g,n.Commands.log("initPosition ".concat(document.documentElement.scrollTop),!0)}break}}}function et(){var e=(0,t.$$)(".message-item");e.forEach(function(t){Se(t,e)}),bt(document),st(document.body.querySelector(".message-header"))}function tt(){n.Commands.checkUserids((0,e.getAvatarUserids)()),E(),V(),At(),k(),rt(!0)}function nt(){if("true"==window.enableLocateToExpand&&g){var e=Date.now();document.body.scrollTop=g,document.documentElement.scrollTop=g,n.Commands.log("domReady ".concat(document.documentElement.scrollTop),!0),setTimeout(function(){var t=Date.now()-e;n.Commands.domReady(),n.Commands.track("email_domready_delay",{delay:t})},0)}else n.Commands.domReady()}function at(){$=!0,clearTimeout(Qe),Qe=setTimeout(function(){ot()},300)}function rt(e){e?window.addEventListener("scroll",at):(clearTimeout(Qe),window.removeEventListener("scroll",at))}function ot(){$=!1,k(),it()}function it(){if(L.size>0){var e,t=new Set,n=l(L);try{for(n.s();!(e=n.n()).done;){var a=e.value;a.loaded?t.add(a):wt(a)&&t.add(a)}}catch(s){n.e(s)}finally{n.f()}var r,o=l(t);try{for(o.s();!(r=o.n()).done;){var i=r.value;L.delete(i)}}catch(s){o.e(s)}finally{o.f()}console.log("finishHandleImgsOnScreen ".concat(L.size))}}function st(e){if(!(void 0===window.keyword||window.keyword.length<1)){var t=".lk-search-highlight";lt(e.matches(t)?[e]:e.querySelectorAll(t),window.keyword)}}function lt(e,t){new o.Search(e,"lk-big-search",Mt).mark(t)}function ct(e){if(!(0,t.isNull)(e)){var n=e.querySelectorAll("div[id^=large-file-area]"),a=e.querySelectorAll(".attachment-item-wrapper .attach_size_2,.attachment-item-wrapper .attach_size_1"),r=[];if(a)for(var o=0;o<a.length;o++)a[o]&&a[o].getAttribute("file-token")&&(r[r.length]=a[o].getAttribute("file-token"));if(n)for(o=0;o<n.length;o++){var i=n[o];if(i){var s=i.querySelectorAll("div");if(s){var l=0;for(o=0;o<s.length;o++){var c=s[o].querySelector("a");c&&(dt(c.getAttribute("href"),r)?s[o].style.display="none":c.getAttribute("href")&&(c.href=c.href+"?source=larkmail_largefile",l++))}l>0&&(i.style.display="block")}}}}}function dt(e,t){if(t&&e)for(var n=0;n<t.length;n++)if(t[n]&&e.indexOf(t[n])>-1)return!0;return!1}function mt(e){if(!(0,t.isNull)(e))for(var n=e.querySelectorAll('a[id^="at-user"]'),a=window.myAddress.split(","),r=0;r<n.length;r++){var o=n[r],i=o.getAttribute("href"),s=o.innerText.substr(1);if(i){for(var l=0;l<a.length;l++){var c=a[l];if(c.length>0&&i.indexOf(c)>-1){o.removeAttribute("style"),o.classList.add("atme");break}}i=i+"?"+s+"?source=larkmail_at",o.setAttribute("href",i)}}}function ut(e){for(var t=e.querySelectorAll("a"),n=0;n<t.length;n++){var a=t[n],r=a.getAttribute("data-microurl");void 0!==r&&null!=r&&r.length>0&&a.setAttribute("href",r)}}function gt(e){return/file.*?blank\.png\?cid=/.test(e)?"cid:"+e.split("blank.png?cid=")[1]:""}function ft(e){try{e?w[e]==y[e]&&Ut(e)&&je():window.imagesloadedcount==window.imagescount&&je()}catch(t){n.Commands.log("fixScale error:"+t,n.LogLevel.error)}}function vt(e,n){var a;if(e.parentNode.classList.contains("loading_container"))a=e.parentNode;else{var r=ze(e),o=r.height,i=r.width;o>0&&i>0&&((a=document.createElement("div")).style.width="".concat(i,"px"),a.style.height="".concat(o,"px"),a.classList.add("loading_container"),a.classList.add("withBackground"),e.parentNode.insertBefore(a,e),a.append(e),(0,t.hideDomElement)(e))}if(a){i=parseFloat(a.style.width),o=parseFloat(a.style.height);var s=a.querySelector(".loading_svg");s&&s.remove();var l=a.querySelector(".error_svg");if(l&&(a.classList.remove("show_error"),l.remove()),o>=48&&i>=48)if((0,t.hideDomElement)(e),n){var c=Ve(e),d=Ue(e),m=c.width||d.width||parseFloat(e.style.width),u=c.height||d.height||parseFloat(e.style.height);if((0,t.isNullOrNaN)(m)&&(0,t.isNullOrNaN)(u)||0==m||0==u)a.classList.contains("loading_container")&&(a.parentNode.insertBefore(e,a),a.remove());else{a.classList.add("show_error");var g=(0,t.convertToNodeFirstElementByStr)('<svg class="error_svg" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M20.87 2.05999C21.42 2.05999 21.87 2.50999 21.87 3.05999V8.64499L19.87 10.645V4.05999H3.86999V20.06H10.455L8.455 22.06H2.87C2.32 22.06 1.87 21.61 1.87 21.06V3.05999C1.87 2.50999 2.32 2.05999 2.87 2.05999H20.87ZM21.87 11.47V21.055C21.87 21.605 21.42 22.055 20.87 22.055H11.285L13.285 20.055H19.87V13.47L21.87 11.47ZM17.755 10.245C17.835 10.325 17.87 10.425 17.87 10.53V12.65L12.455 18.06H10.095C10.065 18.06 10.04 18.055 10.01 18.05L5.73 18.04C5.61 18.04 5.5 17.965 5.455 17.855C5.41 17.745 5.435 17.615 5.52 17.53L9.65499 13.395C9.81 13.24 10.065 13.24 10.22 13.395L12.125 15.3L17.18 10.245C17.345 10.08 17.6 10.08 17.755 10.245ZM17.87 15.47V17.755C17.87 17.92 17.735 18.055 17.57 18.055H15.28L17.87 15.47ZM8.87 6.05999V9.05999H5.87V6.05999H8.87Z" fill="#BBBFC4"/></svg>');a.appendChild(g)}}else{var f=(0,t.convertToNodeFirstElementByStr)('<svg class="loading_svg" width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M5.22051 5.1516C5.33192 5.0401 5.46421 4.95165 5.6098 4.89128C5.7554 4.83091 5.91146 4.79981 6.06908 4.79975C6.2267 4.79969 6.38278 4.83068 6.52842 4.89095C6.67407 4.95121 6.80641 5.03958 6.9179 5.15099C7.02939 5.2624 7.11785 5.39468 7.17822 5.54028C7.23859 5.68588 7.26969 5.84194 7.26975 5.99956C7.2698 6.15717 7.23882 6.31326 7.17855 6.4589C7.11829 6.60454 7.02992 6.73689 6.91851 6.84838C6.24533 7.52037 5.71161 8.31878 5.34803 9.19773C4.98444 10.0767 4.79816 11.0188 4.7999 11.97C4.7999 15.9642 8.02429 19.2 11.9999 19.2C15.9755 19.2 19.1999 15.9642 19.1999 11.97C19.1999 11.6517 19.3263 11.3465 19.5514 11.1215C19.7764 10.8964 20.0816 10.77 20.3999 10.77C20.7182 10.77 21.0234 10.8964 21.2484 11.1215C21.4735 11.3465 21.5999 11.6517 21.5999 11.97C21.5999 17.2878 17.3027 21.6 11.9999 21.6C6.6971 21.6 2.3999 17.2878 2.3999 11.97C2.3999 9.37799 3.4271 6.94618 5.22051 5.1516Z" fill="#bbbfc4"/></svg>');a.appendChild(f)}}}function ht(e,n,a,r){if(e.onload=e.onerror=function(){},n.loaded=e.loaded,r)vt(n,!0);else{n.onImgLoad=function(){},(0,t.showDomElement)(n),n.src=a,n.style.height="auto",n.style.maxHeight="none",We(n);var o=n.parentNode;o.classList.contains("loading_container")&&(o.parentNode.insertBefore(n,o),o.remove())}}function pt(e,t,n,a,r){a?w[a]++:window.imagesloadedcount++,ht(e,t,n,r),ft(a)}function yt(e){var t=e.getAttribute("loading"),n=gt(t),a=!1;null!=n&&n.length>0&&n.startsWith("cid")&&(a=!0,t=n),t&&function(e){var n=new Image;setTimeout(function(){n.loaded||vt(e,!1)},50),n.onload=e.onImgLoad=function(e){return function(){C().onLoad(t),n.loaded=!0,ht(n,e,t,!1)}}(e),n.onerror=function(e){return function(){C().onError(t),a||(n.loaded=!0,ht(n,e,t,!0))}}(e),setTimeout(function(e){return function(){n.loaded||(C().onTimeout(t),n.loaded=!1,ht(n,e,t,!0))}}(e),8e3),n.src=t,C().startRetry(t)}(e)}function wt(e){var t=e.getAttribute("loading"),a=q(e)&&t;return a&&(n.Commands.imageLoadingOnScreen(t),console.log("imageLoadingOnScreen ".concat(t)),console.log(e)),a}function Lt(e,t,a,r){e.getAttribute("loading")||(r?y[r]++:window.imagescount++,L.add(e),e.setAttribute("loading",t),e.src="./images/blank.png",function(e){var o=new Image;setTimeout(function(){o.loaded||vt(e,!1)},50),o.onload=e.onImgLoad=function(e){return function(){o.loaded=!0,n.Commands.imageOnLoad(t,Date.now()),C().onLoad(t),pt(o,e,t,r,!1)}}(e),o.onerror=function(e){return function(){C().onError(t),a||(o.loaded=!0,pt(o,e,t,r,!0))}}(e),setTimeout(function(e){return function(){o.loaded||(C().onTimeout(t),o.loaded=!1,pt(o,e,t,r,!0))}}(e),8e3),n.Commands.imageStartLoad(t,Date.now()),C().startDownload(t),o.src=t}(e))}function bt(e){var n;if(e.closest&&(n=e.closest(".message-item")),n){var a=n.getAttribute("message-id"),r=n.querySelectorAll("div.message-content img");y[a]=0,w[a]=0}else{r=(0,t.$$)("div.message-content img");window.imagescount=0,window.imagesloadedcount=0}for(var o=0;o<r.length;o++){var i=r[o].src,s=gt(i),l=!1;null!=s&&s.length>0&&s.startsWith("cid")&&(l=!0,i=s),i.length>0&&Lt(r[o],i,l,a)}0==r.length&&je(),it()}function Ct(e){try{var t=e.getAttribute("href"),a=new URL(t);if("bytedance.feishu.cn"==a.hostname){var r=a.pathname.split("/")[1];["docs","sheets","wiki","mindnotes","base","file"].includes(r)&&e.classList.add("lk-docs-icon")}}catch(o){n.Commands.log("prePaddingDocItem error:"+o,n.LogLevel.info)}}function St(e){var t=e.closest(".message-item");if(t)var a=[t];else a=e.querySelectorAll(".message-item");for(var r={},o=0;o<a.length;o++){for(var i=a[o],s=i.getAttribute("message-id"),l=i.querySelectorAll("a"),c=new Set,d=0;d<l.length;d++){var m=l[d];if(!m.closest("blockquote")&&!m.closest("[id^=large-file-area]")){var u=m.getAttribute("href");u&&u.length>0&&(c.add(u),Ct(m))}}r[s]=Array.from(c)}n.Commands.checkUrls(r)}function At(){var e=!1;function t(n){n.target.classList.contains("drag-view-title")||n.stopPropagation(),window.removeEventListener("touchend",t,!0),e=!1}window.addEventListener("touchmove",function(n){n.target.closest(".swiper-container")||e||(e=!0,window.addEventListener("touchend",t,!0))},!0)}"loading"!=document.readyState?(n.Commands.log("document.readyState != 'loading'",n.LogLevel.info),Xe()):window.addEventListener("DOMContentLoaded",function(){setTimeout(function(){n.Commands.log("DOMContentLoaded",n.LogLevel.info),Xe()},1)});var kt=null;function qt(e,t,n){kt||(kt=new i.TranslateRecommend(window.translateRecommendTitle)),e?kt.show(t,n):kt.remove(t,!0)}function xt(e){var t=e.querySelector(".original-message-content");Ae(e.querySelector(".translated-message-content"));for(var n=e.querySelectorAll("a"),a=t.querySelectorAll("a"),r=0;r<n.length;r++)for(var o=n[r],i=o.getAttribute("href"),s=0;s<a.length;s++){var l=a[s],c=l.getAttribute("href");if(i&&c&&i==c&&i.trim()==o.innerText.trim()){o.innerText=l.innerText;break}}}function Nt(e,n){var a=e.closest(".message-item").querySelector(".is_body_clipped"),r=e.querySelector("[larkmailquote=true]"),o=n.querySelector("[larkmailquote=true]");if(r&&o){var i=(0,t.getQuoteClassPostfix)(r),s="collapse".concat(i),l=r.closest(".quoteControlRoot"),c=(0,t.getQuoteClassPostfix)(o),d="collapse".concat(c),m=o.closest(".quoteControlRoot");if(l&&m){var u="none";l.classList.contains(s)?(m.classList.add(d),u="none"):(m.classList.remove(d),u="flex"),a&&(a.style.display=u)}}}window.toggleTranslationLoading=function(e,a){n.Commands.log("toggleTranslationLoading",n.LogLevel.info);var r=Ut(e);if(!(0,t.isNull)(r)){var o=r.querySelector(".translation-loading-bar");if(!(0,t.isNull)(o))if("true"===a){zt(o);var i=r.querySelector(".translation-operation-bar");(0,t.hideDomElement)(i),Pt(!1,r)}else Yt(o)}},window.showTranslateRecommend=function(e){for(var t=JSON.parse(e),n=0;n<t.length;n++){var a=t[n];qt(a.show,a.messageID,a.displayText)}},window.updateTranslation=function(e,r,o,i,s,l,c){n.Commands.log("updateTranslation",n.LogLevel.info);var d=Ut(e);if(!(0,t.isNull)(d)){Yt(d.querySelector(".translation-loading-bar"));var m=d.querySelector(".original-message-content"),u=d.querySelector(".translated-message-content");u||(u=(0,t.convertToNodeFirstElementByStr)('<div class="message-content translated-message-content lk-search-highlight"></div>'),m.parentNode.insertBefore(u,m.nextSibling)),(0,t.isNull)(m)||(0,t.isNull)(u)||(r?(m.style.display="none",u.style.display="block",u.innerHTML=s,(0,a.formatContent)(u),c&&u.classList.add("showPopover"),xt(d),Nt(m,u),bt(d)):(m.style.display="block",u.style.display="none",u.classList.remove("showPopover"),je(),Nt(u,m)));var g=d.querySelector(".translation-language");!(0,t.isNull)(g)&&l&&l.length>0&&(g.innerText=l);var f=d.querySelector(".translation-operation-bar");(0,t.isNull)(f)||(kt&&kt.remove(e,!1),(0,t.showDomElement)(f.querySelector(".language-drop-down-icon")),(0,t.showDomElement)(f));var v=d.querySelector(".translation-view-original-button"),h=d.querySelector(".translation-view-translation-button");(0,t.isNull)(v)||(0,t.isNull)(h)||(r?((0,t.showDomElement)(v),(0,t.hideDomElement)(h)):((0,t.hideDomElement)(v),(0,t.showDomElement)(h))),Wt(!1,d),Pt(!0,d),jt(r,o,c),Vt(d,r,i)}},window.updateHeaderTop=function(e){if(e){var t=document.body.querySelector(".body-content");t&&(t.style.marginTop="".concat(e,"px"))}},window.updateHeaderHeight=function(e){var n=parseFloat(e);if(!isNaN(n)){var a=(0,t.$)("lk-native-title");a&&(a.style.height="".concat(n,"px"))}},window.dismissTranslation=function(e){n.Commands.log("dismissTranslation",n.LogLevel.info);var a=Ut(e);if(!(0,t.isNull)(a)){Yt(a.querySelector(".translation-loading-bar"));var r=a.querySelector(".translation-operation-bar");(0,t.hideDomElement)(r);var o=a.querySelector(".original-message-content"),i=a.querySelector(".translated-message-content");(0,t.isNull)(o)||(0,t.isNull)(i)||(o.style.display="block",i.style.display="none"),Wt(!0,a),Pt(!1,a),jt(!1,""),Vt(a,!1,"")}},window.updateSafetyBanner=function(e,t,n){s.SafetyBanner.update(e,t,n)},window.startSearch=function(){var e=[];(0,t.$$)(".message-item").forEach(function(t){if(null==t.querySelector(".item-content")){var n=t.getAttribute("message-id");n&&e.push(n)}}),n.Commands.needContents(e,f.search)};var Tt="mail_title",Et={},_t=void 0,$t=void 0,Bt=void 0;function It(){Rt(),n.Commands.exitSearch()}function Ot(e,a){n.Commands.log("testSearchABC locateSearchTo ".concat(e,", ").concat(a));var r=Et[e];if(r&&r.matchNodes&&r.matchNodes[a]&&r.matchNodes[a][0]){var o=r.matchNodes,i=o[a=Math.min(Math.max(a,0),o.length-1)][0];$t&&i!==$t&&($t.classList.remove("lk-located"),Bt.updateFakeEllipsis($t));var s=i.closest(".message-item");if(s&&!s.classList.contains("expand")&&s.classList.add("expand"),i.closest(".quoteRendered")){var l=s.querySelector("[larkmailquote=true]");if(l){var c=(0,t.getQuoteClassPostfix)(l),d="collapse".concat(c);l.closest(".".concat(d))&&F(l)}}console.log(i),i.classList.add("lk-located"),r.updateFakeEllipsis(i),$t=i,Bt=r,i&&i.classList.contains("disable-scroll-horizontal")?te(i,80,!0):te(i,80)}}function Mt(e){if(e instanceof HTMLElement){var t=getComputedStyle(e);return"none"===t.display||"hidden"===t.visibility}return!1}function Dt(e){Ht(Ut(e))}function Ht(e){var t=e.getAttribute("message-id");if(t&&e&&_t){Zt(e,_t);var a=Qt(e),r=e.querySelector(".message-content.original-message-content");if(r&&"none"===r.style.display&&(r=e.querySelector(".message-content.translated-message-content")),a&&a.length>0){var o=Ft([r],t);o&&_t&&n.Commands.searchResults(_t,1,[{messageId:t,count:0|o.matches}])}}}function Ft(e,t){if(_t){var n=new o.Search(e,"lk-content-search",Mt);return n.mark(_t),Et[t]=n,n}}function Rt(){for(var e in Et){Et[e].unmark()}Et={},$t=void 0,Bt=void 0,_t=void 0}function Pt(e,a){if(a){var r=a.querySelector(".turn-off-translate");(0,t.isNull)(r)||(e?(0,t.showDomElement)(r):(0,t.hideDomElement)(r))}else n.Commands.log("toggleTurnOffTranslationButton no message item",n.LogLevel.error)}function Wt(e,a){if(a){var r=a.querySelector(".translate");(0,t.isNull)(r)||(e?(0,t.showDomElement)(r):(0,t.hideDomElement)(r))}else n.Commands.log("toggleTranslateButton no message item",n.LogLevel.error)}function jt(e,n,a){var r=(0,t.$)(".message-title-and-labels"),o=r.querySelector(".subject-translation-boarder-line"),i=r.querySelector(".subject-translation"),s=r.querySelector(".message-subject");if(!((0,t.isNull)(r)||(0,t.isNull)(o)||(0,t.isNull)(i)||(0,t.isNull)(s))){var l=e&&!(0,t.isNull)(n)&&"string"==typeof n&&n.toString().length>0,c=l?"inline":"none";i.style.display=c,i.innerText=n,o.style.display=a?"none":c,s.style.display=l&&a?"none":"",e&&a?i.addEventListener("click",ue):i.removeEventListener("click",ue)}}function Vt(e,a,r){if(e){var o=e.querySelector(".original-plain-text"),i=e.querySelector(".translation-plain-text");(0,t.isNull)(o)||(0,t.isNull)(i)||(a?((0,t.hideDomElement)(o),(0,t.showDomElement)(i),i.innerText=r):((0,t.showDomElement)(o),(0,t.hideDomElement)(i)))}else n.Commands.log("toggleTranslationSummary no message item",n.LogLevel.error)}function Ut(e){if(!(0,t.isNull)(e)){var n=(0,t.$)('.message-item[message-id="'.concat(e,'"]'));if(!(0,t.isNull)(n))return n}}function zt(e){if(!e.querySelector(".translation-loading-icon")){var n=(0,t.convertToNodeByStr)('<svg width="45"  height="45"  xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid" class="lds-rolling translation-loading-icon" style="background: rgba(1, 0, 0, 0);"><circle cx="50" cy="50" fill="none" ng-attr-stroke="{{config.color}}" ng-attr-stroke-width="{{config.width}}" ng-attr-r="{{config.radius}}" ng-attr-stroke-dasharray="{{config.dasharray}}" stroke="#3370ff" stroke-width="9" r="43" stroke-dasharray="150, 70" transform="rotate(305.873 50 50)"></circle></svg>');n.setAttribute("id","translation-loading-svg"),n.style.display="flex",e.insertBefore(n,e.firstElementChild)}(0,t.showDomElement)(e)}function Yt(e){var n=e.querySelector("#translation-loading-svg");(0,t.isNull)(n)||n.remove(),(0,t.hideDomElement)(e)}function Qt(e){var t=e.querySelector(".message-content.original-message-content");t&&"none"===t.style.display&&(t=e.querySelector(".message-content.translated-message-content"));var a=[];t&&a.push(t);for(var r=e.querySelectorAll(".attachment-name"),o=0;o<r.length;o++)a.push(r[o]);return n.Commands.log("generateMessageContentDoms get "+a.length,n.LogLevel.info),a}function Zt(e,t){var a=e?e.querySelectorAll(".attachment-name"):null;if(n.Commands.log("expandIfHitHiddenAttachment nodelist size: "+a.length,n.LogLevel.info),a&&!(a.length<4)){for(var r=[],i=3;i<a.length;i++)r.push(a[i]);var s,l=new o.Search(r,"check_if_need_expand",!1);if(l.mark(t),n.Commands.log("expandIfHitHiddenAttachment search matches size: "+l.matches.length,n.LogLevel.info),l.matches&&l.matches>0)(s=e.matches(".message-attachments-wrapper")?e:e.querySelector(".message-attachments-wrapper"))&&!s.classList.contains("expand")&&s.classList.add("expand");l.unmark()}}window.search=function(e){n.Commands.log("testSearchABC search start ---\x3e ".concat(e),!0),e!=_t&&Rt(),_t=e;var a=(0,t.$$)(".message-item"),r=[];function i(t,a){if(n.Commands.log("searchDom: "+t,n.LogLevel.info),t&&a){var i=new o.Search(t,"lk-content-search",Mt);i.mark(e),r.push({messageId:a,count:i.matches||0}),Et[a]=i}}i([(0,t.$)(".message-subject")],Tt);for(var s=0;s<a.length;s++){var l=a[s];Zt(l,e),i(Qt(l),l.getAttribute("message-id"))}var c="testSearchABC search finish ---\x3e ".concat(e," resultInfo ").concat(JSON.stringify(r));n.Commands.log(c,!0),n.Commands.searchResults(e,0,r)},window.locateSearch=function(e,a,r){if(n.Commands.log("testSearchABC locateSearch to "+e+" "+a,!0),Et[e])Ot(e,a);else if(e!=Tt||(0,t.$)(".message-subject")){var o=(0,t.$)('.message-item[message-id="${msgId}"] .message-content');if(n.Commands.log("testSearchABC locateSearch start search",!0),o||r&&r.length>0){function i(t){n.Commands.log("testSearchABC searchAndLocate to "+e+" "+a,!0),console.log(t),Zt(t,_t);var r=Ft(Qt(t),e);n.Commands.searchResults(_t,1,[{messageId:e,count:0|r.matches}],a),Ot(e,a)}n.Commands.log("testSearchABC locateSearch start search messageContent",!0),o?(n.Commands.log("testSearchABC locateSearch hasContent",!0),i(o)):(n.Commands.log("testSearchABC locateSearch addMessageContent",!0),G(e,r,function(e){i(e)}))}else n.Commands.needContentLocateSearch(e,a)}else $t&&$t.classList.remove("lk-located")},window.exitSearch=function(){Rt()},window.locateTo=Ot;
},{"./avatar":"IjMb","./utils":"FOZT","./commands":"TnH5","./renderQuote":"dnLp","./popover":"BRBp","./search":"zfSF","./translateRecommend":"N3t7","./safetyBanner":"vpJJ"}]},{},["Focm"], null)